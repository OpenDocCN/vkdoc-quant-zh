© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023F. Cecconi (ed.)AI in the Financial Markets Computational Social Sciences[`doi.org/10.1007/978-3-031-26518-1_7`](https://doi.org/10.1007/978-3-031-26518-1_7)

# 7. ML 应用于金融市场

Riccardo Vasellini^(1  )(1)Universitá di Siena, Siena, ItalyRiccardo VaselliniEmail: r.vasellini@student.unisi.it

## 摘要

全球正在被数据淹没，并且新数据收集的速度呈指数级增长。这在仅仅二十年前还不是这样的情况，即使存在于机器学习使用的技术限制，缺乏用于喂养算法的数据也构成了额外的障碍。此外，如果获取精确和有意义的数据导致成本过高，那么获取与我们需要分析的金融现象不直接相关的数据可能更具成本效益，即所谓的替代数据集。替代数据的最终目的是为交易员提供信息优势，以寻找产生阿尔法或与其他任何事情无关的良好投资回报的交易信号。一种策略可能仅基于搜索引擎中免费提供的数据，然后 ML 系统可以将其与某些金融事件相关联。

关键词 AI 机器学习 Riccardo Vasellini

拥有土木、环境和管理工程背景的博士研究生。我目前在意大利锡耶纳大学信息科学系就读，专攻复杂系统。在科学界，我的目标是利用基于代理的建模和人工智能来获得对复杂系统的重要见解。我认为研究新兴现象和系统动态对做出明智的决策至关重要。在攻读博士学位期间，我在多个行业担任项目经理，包括房地产开发、房地产投资组合管理、可再生能源和旅游业。

## 7.1 引言

过去的十年见证了数据存储和收集在许多行业中的显着增加，包括金融领域。这使得金融机构、投资者、保险公司以及任何对股票、衍生品和利率变动感兴趣的人都能够利用以前缺乏计算能力和数据的机器学习技术。

AI 和 ML 可以应用于各种金融领域，包括投资组合战略制定、欺诈和非法活动检测、风险评估和管理、法律合规、算法交易等。

在本章中，我们将介绍文献中找到的应用示例，金融中的建模技术和 ML 范例。我们将总结使用这些技术的限制和危险，以及未来的展望。

## 7.2 基础知识

机器学习可以分为三个主要领域：监督学习、无监督学习和强化学习。

监督学习可能是机器学习中最简单的形式，线性回归是其中的一个算法示例，早在“人工智能”或“机器学习”这些术语出现之前就已经被使用了几十年。除了线性回归，监督学习还包括其他算法，例如逻辑回归、决策树、K-最近邻算法、支持向量机、神经网络等。其主要特点是使用包含数据点特征的标签数据集。整个目的是找到一个能够在对算法进行训练后将数据点特征映射到它们相应标签的函数。这种范式假设我们对正在寻找的答案有所了解。一旦训练并测试了算法找到的映射，就可以将其应用于未标记的数据。这可以用于分类或回归问题。

无监督学习涉及在数据中识别模式。通常需要搜索簇或相似发现的分组。在实践中，机器学习算法将相似的事物聚集在一起，其中相似性通常以与簇中心的距离表达。一个好的算法对数据的规模是不可知的，因此通常会采用特征缩放技术，如 z-分数归一化或最小-最大方法。最常用的聚类技术是 k 均值聚类，但也使用其他技术，如基于分布、基于密度或层次聚类。

强化学习围绕着多步决策制定展开。一个代理根据其对所处环境中收益和成本的估计而采取行动，该环境由一系列状态描述，通常为马尔可夫决策过程。奖励（减去成本）是使用 Q 函数计算的，如果某个行动导致具有最高 Q 值的状态，则该行动是最佳的。一个重要的概念是探索，一个“智能代理”总是有可能执行随机动作，这样做是为了不陷入仅利用提供奖励而不探索可能导致更好结果的不同状态。代理不需要标记数据。

推动机器学习应用的不仅仅是对这些新技术的获取。世界正被数据淹没，新数据的获取速度呈指数增长。这在仅仅二十年前还不是这样，即使机器学习的应用存在技术限制，缺乏用于训练算法的数据也构成了一道额外的障碍。此外，当收集准确和有价值的数据成本过高时，获得与我们需要分析的金融现象没有直接联系的数据可能更具成本效益，即所谓的替代性数据集。替代性数据的最终目标是为交易者提供信息优势，以寻找产生阿尔法或与其他任何因素无关的正收益的交易信号（Jensen 2018）。一个策略可能完全基于来自搜索引擎的免费可用数据，这些数据可能通过机器学习算法与某些金融现象相关联。例如，想象一下对冲基金 Cumulus，它只使用天气数据来交易农业公司。

最后，通过结合机器学习算法、当代计算能力和大量数据，我们可以构建出金融领域的强大应用程序，现在我们将进行探讨。

## 7.3 应用领域

### 7.3.1 投资组合管理

自从 Markowitz 在 1952 年提出以来，均值-方差优化（MVO）一直是构建投资组合的主要范式。MVO 的成功与二次规划（QP）的成功紧密相连，这使得解决 MVO 变得简单(Jensen 2018)。提出的一种替代方法是风险预算方法，简单来说，投资组合为每种资产类型分配风险预算，我们试图根据这些预算分配资产风险。这种方法在 PO 的各个领域中占主导地位。不幸的是，它通常涉及处理非线性，使得难以解决。然而，就像机器学习在最近几年发展一样，PO 也在发展，虽然 QP 被选择为其简单的计算方法，但如今使用了一整套更消耗计算资源的新算法。其中包括为大规模机器学习问题开发的算法：坐标下降、交替方向乘子法、近端梯度和 Dykstra 算法。使用这些算法可以超越 QP 范式，并深入研究一整套不受线性限制的模型。PO 的未来是利用这些机器学习算法开发新的 PO 模型，或者简单地使用已经开发的模型，这些模型现在在计算上比过去更容易接近。

作为这种方法的一个示例，Ban，El Karoui 和 Lim（Perrin 2019）在 2018 年提出了一种基于绩效的正则化（PBR）和基于绩效的交叉验证模型，以解决投资组合优化问题，以超越应用经典方法到真实数据时产生的估计问题。正则化是几十年来解决围绕线性问题的问题的一种技术，但实际上，问题的常数的微小变化会导致解的巨大偏差。在实践中，它是一种约束或减少估计系数为零的回归。因此，它通过阻止学习更复杂的模型来防止过拟合的风险。在实践中，它减少了模型的方差，而不会增加太多其偏差。

作者们对投资组合优化问题进行正则化，目的是改善解的样本外表现。为了实现这一点，他们限制了投资组合风险和平均值的样本方差。目标是创建一个模型，能够找到一个解决投资组合问题的解（无论是传统问题还是 CVaR 问题），其偏差非常低，而且在样本外表现良好。

在另一篇论文中（Jensen 2018），Perrin 和 Roncalli 确定了可以被视为投资组合优化中最重要的四种算法：坐标下降法，交替方向乘子法，近端梯度法和迪杰斯特拉算法。作者们评估了 MVO 范式的成功在于缺乏竞争的可实施模型。确定的原因包括难以估计参数和复杂的目标函数，使用提到的四种算法的组合可以构建一个能够考虑 QP 形式之外的分配模型的框架。

最后，Ban 等人（Ban et al. 2018）提出了一种创新的方法。作者们试图解决投资组合管理中的数据异质性和环境不确定性问题。他们使用强化学习来做到这一点。具体来说，为了包含异构数据并提高对环境不确定性的韧性，他们的模型（增强状态强化学习，SARL）使用价格变动预测来增强资产信息，这些预测可能仅基于金融数据或来自新闻等非传统来源。通过对比特币价格和高科技股票市场的历史数据进行测试，他们验证了这种方法，展示了总体和风险调整利润的模拟结果。

一般来说，机器学习与计算能力的进步使得科学家和专业人员能够测试不受数量限制的模型，一度不切实际的解决方案正变得可以实现。

### 7.3.2 风险管理

风险管理（RM）由于机器学习算法的使用，对处理大量变量和数据的新旧模型的采用增加了，并且现在这些算法能够在可接受的时间内找到答案。

风险贯穿金融世界及其他领域。我们将探讨机器学习如何用于其最常见的一些形式。

在处理信用风险时，了解债务人偿还债务的概率对金融机构（或一般的出借人）来说是至关重要的知识。这在处理中小企业或零售投资者时尤其困难，因为可用数据稀缺且有时不准确。文献中可以找到的各种模型的一般思想是，使用机器学习可以在不传统地与预测信用风险相关联的数据中找到这些小额借款人行为的模式（Ban 等人，2018）。

另一个机器学习蓬勃发展的领域是评估复杂衍生品的信用风险，例如信用违约互换（CDS）。对于这些对象，深度学习方法显示出比传统方法更好的结果，在研究中，Son、Byun 和 Lee 模型（Ye 等人，2020）显示他们所使用的参数模型在预测性能方面一直比基准模型更好，并且在所有使用的模型中，人工神经网络（ANN）显示出最佳结果。

目前，机器学习在市场交易风险管理中的主要用途是通过在大量数据上进行回溯测试来验证提出的模型。另一个关键应用是了解交易将如何影响不流动的市场，从而改变所交易资产的价格。通过使用机器学习算法来识别类似资产，可以避免单一资产的高交易量带来的困难。

在此框架内的一个有趣的应用来自 Chandrinos、Sakkas 和 Lagaros（Lynn 等人，2019）。这些研究开发了一个工具，将机器学习作为投资风险管理工具。具体而言，该调查集中于通过使用人工神经网络（ANN）和决策树（DT）将交易策略生成的信号分类为成功和不赚钱的信号。为此，他们使用了两个先前提出的货币组合，并利用他们的人工智能风险管理系统（AIRMS）通过减少损失而不是增加收益来提高其性能。在他们的回测中，不仅所采用的两种方法（DT 和 ANN）提高了投资组合的盈利能力，而且还通过减少标准偏差显着改善了它们的夏普比率。

另一个应用是由 Sirignano、Sadhwani 和 Giesecke 提出的（Son 和 Lee 2016）。他们使用深度学习模型分析了美国在 1995 年至 2014 年间发放的超过 1.2 亿笔抵押贷款数据。试图理解某些借款人行为的概率以及产生不良贷款风险，他们查看了各种变量，包括金融和宏观经济因素。他们得出的结论是，预测抵押贷款成功的最重要因素之一是抵押贷款发放地区的失业率，突显了住房金融市场与宏观经济之间的联系。

### 7.3.3 房地产科技

房地产科技是房地产行业内新兴技术的广泛应用。这些技术包括房屋匹配工具、无人机、虚拟现实、建筑信息模型（BIM）、数据分析工具、人工智能（AI）、物联网（IoT）和区块链、智能合同、房地产行业的众筹、与房地产相关的金融技术（fintech）、智能城市和地区、智能家居以及共享经济（Spyros 等人 2018） 。房地产行业与金融市场密切相关，特别是在涉及到上市的房地产投资信托基金（REIT）方面，在美国，这些基金的市值已经超过 1 万亿美元（Sirignano 等人 2018）。

在这种情况下，准确预测房价具有明显的相关性。不幸的是，要做到这一点准确性需要对当地市场和周围环境有深入的了解，这种类型的知识对于运营大量房产或每天定价数百份抵押品的大型房地产投资信托基金或信贷机构是难以获取的。

Siniak 等人提出了一个解决方案（2020）。作者认为，通常使用的指数很少准确地描绘了房地产市场的细粒度情况。事实上，他们试图利用超过 16 年的房屋销售数据，得出对单一房屋的定价预测准确性。

所提出的方法称为梯度增强房价指数，它使用了梯度增强回归树算法的机器学习技术，该算法构建了多个决策树并递归拟合模型。实际上，他们颠倒了多个决策树构建过程，这将导致过度拟合的分类树（每个房屋一个叶子节点），构建一个低复杂度的决策树（弱学习器），然后在发生糟糕预测时构建其他低复杂度的树。最终获得的树被称为强学习器，并且可以被看作是弱学习器的加权平均值。作者认为，这种方法能够以比现有的经典指数更好的方式预测房价，对金融机构和房地产基金将会非常有用。

### 7.3.4 资产回报预测

预测资产的确切正确价格是金融界的圣杯。能够做到这一点将会带来财富和财富，因此问如何用尽可能小的误差来做到这一点肯定是一个非平凡的问题。事实上，金融科学最重要的结果之一，布莱克-斯科尔斯模型，就是用于这个原因：定价一种资产，具体地说，是一个期权（卡波林等人 2021）。

资产价格遵循高度非线性的行为，受到反馈回路的影响，有时会出现繁荣和萧条周期（巴尔等人 2016），应对这些特征的强大工具当然是深度学习。预测资产价格的问题等同于预测时间序列的行为，在经济学和金融学中，这通常是使用动态因子模型（DFM）完成的。DFM 可以被视为多个时间序列的联动模型。

深度学习可用于整合这些模型。例如，我们可以看一下冯、何和波尔森（布莱克和斯科尔斯 1973）。为了预测资产回报，作者开发了使用深度学习训练的动态因子模型。使用随机梯度下降，同时计算隐藏成分和回归系数，从而提高了与传统模型相比的样本外性能。

### 7.3.5 算法交易

算法交易通过计算机的自动化，执行执行某种交易策略所需的全部或部分步骤。它可以被视为量化交易的基本部分，并且根据华尔街的数据，算法交易占美国股票交易总量的约 60-73%。（冯等人 1804）。

量化交易的发展可以总结为三个主要阶段：

在第一个时代（80 年代至 90 年代），量化公司会使用从学术研究中得出的信号，通常使用来自市场或基本数据的单个或极少量的输入。策略通常相当简单，困难在于迅速获取正确的数据。

在第二阶段（2000 年代），为了探索套利机会，基金采用算法来识别受到价值或动量等风险变量影响的资产。在这个阶段，主要采用基于因子的投资，这是导致 2007 年 8 月量化领域动荡的因子行业。

最后一个阶段就是我们正在经历的阶段，基金正在利用机器学习和替代数据进行投资，以开发有效的交易信号用于循环交易方法。在这个极其竞争的环境中，一旦发现有价值的异常情况，它就会迅速消失，因为竞争激烈。（情报 2022）。

使用机器学习进行交易的主要目标是预测资产基本面、价格走势或市场情况。 一种策略可能使用多种机器学习（ML）算法来实现这一点。 通过结合有关个别资产前景、资本市场预期以及证券之间关系的预测，下游模型可以提供组合级别的信号。

许多交易算法使用市场上的技术指标来调整投资组合构成，增加其预期收益或减少其风险。

作为应用示例，我们可以看一下雷、彭和沈利用深度学习改进了技术分析中常用的指标——移动平均收敛/发散（MACD）（雷等人 2020）。 作者首先指出，传统的 MACD 技术无法理解趋势变化的幅度，这可能会导致算法在实际上没有大的趋势变化但只是波动时发出交易信号。 这将导致由于交易成本而造成不必要的损失。 因此，通过残差网络，可以估计代表所交易股票的时间序列的某些特征，特别是作者关注的 MACD 指标将发出交易信号的时间序列的局部峰度。 如果残差网络估计的峰度高于 0（意味着曲线的陡度高于正态分布），则算法将相信所指示的交易点并执行交易，否则将忽略它并保持持仓。

在 CSI300 股票指数上进行测试，所提出的算法优于仅使用 MACD 的经典算法，显示了通过 ML 可以改进现有的算法交易策略。

## 7.4 风险与挑战

尽管提供了许多优势，但在金融领域使用 ML 也无法免受其常见缺陷的影响。

在所有领域中，包括金融领域，机器学习模型的复杂性是导致其风险性的主要因素。 机器学习的算法基本上相当困难，因为它们操作的是大规模且有时结构不清的数据，例如文本、照片和声音。 因此，对这些算法的训练需要复杂的计算基础设施，以及模型构建者方面的高度专业知识和理解（Sen 等人 2021）。 此外，复杂性可能会使算法难以被最终用户实施，这可能是因为计算基础设施不适合在任务规定的时间限制内提供答案。

大多数机器学习模型都是*黑盒子*，这意味着用户可能知道问题的答案是什么，但不知道它是如何找到的。这可能导致几个问题和法律纠纷。例如，考虑一个依赖机器学习来评估合同保费的保险公司。如果无法解释保险公司是如何估算价值的，客户可能会犹豫是否与承保人签订合同。同样，如果银行拒绝客户访问信用而不提供原因，银行可能会面临后果。虽然许多应用程序（比如向客户推荐产品）不需要模型可解释性，但许多其他应用程序需要，而无法做到这一点可能会阻碍机器学习在金融界的应用进展。

另一个挑战是偏见。数据收集的方式可能会影响所使用的机器学习算法提供的答案。现成的数据本质上偏向于复制现有做法。想象一下来自信用机构的数据，客户根据他们接受（或未接受）的贷款类型进行分类。使用机器学习，我们可能只是不断地复制过去使用的相同决策过程，而没有创新任何东西，实际上是在重新发明轮子。偏见可能出现在性别或种族方面，造成道德问题，并使用户面临歧视诉讼。为了避免这种偏见，进行准确的数据清洗、特征选择和提取至关重要。

来自对抗性机器学习的进一步风险，是向机器学习算法提供错误数据以欺骗其朝向某些结果的做法。著名的案例是纳文德·萨拉奥（Wang 2015），一个年轻的英国人通过创建大量订单然后取消它们（一种称为操纵的做法）而触发了 2010 年闪电市场崩盘，从而诱使算法交易机器人修改其策略并人为修改市场。对抗性机器学习的最佳解决方案是人工监控，然而，当算法是黑盒子时，这变得具有挑战性，并且需要更多的可解释性才能成功。

最后，另一个主要关注点无疑是如何不违反数据隐私，特别是涉及敏感的财务信息时。许多政府正在采取措施解决处理个人数据带来的问题，最值得注意的行动无疑是于 2018 年 5 月生效的欧盟 GDPR。

## 7.5 结论

如今，机器学习以某种方式渗透到每个行业。金融作为一个行业和一个研究领域，一直倾向于计算方法，使用机器学习只能被视为这种态度的自然发展。

我们探讨了各种应用，特别是大部分似乎都围绕着投资组合管理和优化展开。实际上，即使我们在谈论风险管理，我们也可能正在谈论投资组合优化的一个子领域，而算法交易可以被视为投资组合管理规则和模型的自动实施。

其他重要领域包括资产定价和客户分类。关键似乎不仅是所使用模型的类型，而且还包括所获取数据的清洁度。使用正确的数据对于避免偏见并获得创新性见解至关重要。然而，这是一个微妙的过程，因为在处理金融数据时很容易侵犯个人隐私。

主要关注点来自于复杂模型的脆弱性，这些模型通常对于不了解所使用模型的用户来说是黑匣子，这些用户可能容易受到剥削，其中一个例子就是“欺骗”的实践。

总之，机器学习正在为金融世界带来一场巨大的创新浪潮，而且正如所有重大产业变革一样，监管和规范是避免投机和剥削的关键。
