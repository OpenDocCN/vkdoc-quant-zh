金融数学与金融科技系列编辑郑志勇，中国人民大学，北京，中国彭艾伦，多伦多大学，加拿大安大略省，多伦多

本系列涵盖了与金融相关的数学理论的新兴进展和所有金融科技观点的应用研究。这是一系列专著和专题论文集，重点探讨了金融数学（如应用数学、统计学、优化和科学计算）以及金融科技应用（如人工智能、区块链、云计算和大数据）的深入探索。该系列以对金融数学和金融科技的全面理解和实际应用为特色。该书系涉及金融数学和金融科技在实际项目和公司中的前沿应用。

《金融数学与金融科技》图书系列促进了金融数学和金融科技的新兴理论和技术在学术界和金融从业者之间的交流。它旨在及时反映面向金融应用的数学和计算机科学的最新发展。作为一个系列，该书系为学术界、金融界、与金融相关的政府雇员以及希望扩展他们在金融数学和金融科技方面知识的其他任何人提供了宝贵资源。

本系列的关键词包括但不限于：

a) 金融数学

b) 金融科技

c) 计算机科学

d) 人工智能

e) 大数据

托马斯·巴罗和拉斐尔·杜阿迪

# 金融市场的人工智能

## 多模型方法

![](../images/519851_1_En_BookFrontmatter_Figa_HTML.png)出版商徽标：Thomas BarrauAXA Investment Managers Chorus Ltd，香港，香港特别行政区Raphael Douady经济中心，巴黎索邦大学，巴黎，法国ISSN 2662-7167e-ISSN 2662-7175金融数学与金融科技ISBN 978-3-030-97318-6e-ISBN 978-3-030-97319-3[https://doi.org/10.1007/978-3-030-97319-3](https://doi.org/10.1007/978-3-030-97319-3)数学主题分类（2010）：62P2062P2568T0191B0591G1091G1591G70© 编辑（如果适用）和作者，由 Springer Nature Switzerland AG 独家许可 © 2022 版权所有。本作品受版权保护。所有权利由出版商独家和专有许可，无论涉及整体还是部分材料，特别是翻译权、再版、插图重用、朗诵、广播、电影或任何其他物理方式的复制，以及信息存储和检索、电子适应、计算机软件或现在已知或今后开发的类似或不同的方法。在本出版物中使用一般描述性名称、注册名称、商标、服务标记等，并不意味着，即使没有特定声明，这些名称免于相关的保护法律和法规的约束，因此可以自由使用。出版商、作者和编辑可以放心地认为本书中的建议和信息在出版日期被认为是真实和准确的。出版商、作者或编辑对本书中包含的材料或可能存在的任何错误或遗漏不做任何明示或暗示的保证。出版商对已发表的地图和机构隶属关系的司法主张保持中立。

该 Springer 子品牌由注册公司 Springer Nature Switzerland AG 发行。

注册公司地址为：瑞士 Cham 市 Gewerbestrasse 11 号。

前言

本书介绍了一种利用非线性性进行金融投资的可行方法。它总结了 Raphael Douady 和合作者们近二十年来进行的研究。这项研究由 Thomas Barrau 进行了多方面的合作。

通常，变量之间的关系是非线性和嘈杂的。当试图将目标变量与几个解释变量联系起来时，通过精细建模多维线性往往会遭受维度诅咒而不带来明显的好处。Polymodels通过保留一维非线性并根据手头的任务提出各种聚合方法来简化此方法。例如，在预测的情况下，每个一维模型都会产生一个预测。然后选择最相关的预测结果，可能在存在歧义的情况下平均，以得出最终的预测结果。在定义风险指标的情况下，由于衰退通常与相关性增加相关，因此会分析拟合度指标的分布。它可以被看作是一种集成学习形式。

第一个任务是进行一维非线性回归。介绍了几种方法，包括非参数核回归，但首选方法是对解释变量的非线性函数（由于其正交性质，使用厄米多项式）进行线性回归，进一步通过收缩到线性分量来减轻过拟合。

初始因子的非线性转换可以用作新的变量或特征，以供机器学习算法使用。提取的非线性的另一个用途是将其凸性转换为抗脆弱性得分（以N.N. Taleb的观点）。这些分数随后可以用作构建多空投资组合的因子。Polymodel方法可以在市场、行业或个别股票的级别实施。借助贝叶斯调节，它可以结合数百个因素的信息。

总之，polymodels为投资、预测和风险管理提供了一种非常可行的方法。Barrau和Douady在这本书中描述了该方法及其应用，书中充满了示例和回测，必将激励无数的金融从业者。

布鲁诺·杜皮雷序言

像许多创新性的想法一样，*polymodels*是在一个非常紧张的局势下出现的。我们刚开始Riskdata公司风险软件，针对买方的，纽约的双子塔被击中了。这个事件改变了世界的面貌，并严重地使我们初创的项目岌岌可危。至少一年内没有机会签订任何合同。当我们正准备放弃这个项目并找到一份有工资的工作时，一个对冲基金经理向我们提出了以下挑战：*仅*根据*基金的经审计月度回报，我们能够可靠地说出他们的策略、风险以及它们如何适合包含流动资产和另类资产的投资组合吗？*

这个挑战远远超出了对经典绩效指标的简单评估，比如夏普比率、下行波动率、贝塔、法玛-法国因子分析等。这些行业广泛使用的指标被认为提供了过去的相关信息，但对于未来的行为却没有真正可靠的信息。我们发现，即使是一款功能复杂的软件，如果忽略了投资者和经理之间讨论的关键点，它也会忽略掉房间里的大象。因此，我们要求这位经理让我们在他与要么已经投资或者计划投资的经理们的一些会议上悄悄地参加。令我们惊讶的是，投资者只会花几分钟时间谈论相关性和波动性，然后其余的一个小时都在谈论对于特定策略而言相关的特定时刻：经理是如何经历这样或那样的事件的？;他是什么时候以及如何调整他的立场？;以及其他类似的问题。我们的挑战是将这些问题放入一个足够系统化的软件中，以自动解决它们。这个想法*不是*严格复制这些问题，因为答案不会明确地在基金回报中，而是创建一个统计框架，机械地提供最佳答案，考虑到回报信息。

解决方案必须结合基金所处的金融环境。单独的回报并不具有很高的信息量。只有与其他市场相关时，它才变得如此。首先要解决的问题是：哪些市场因素与基金有统计学关系，以及如何？请注意，如果我们不想错过主要风险，这里可能的因素范围可以非常广泛。仅对几个因素进行多元回归肯定无法解决问题。第二个观察结果是，异常大的事件承载了大部分信息。从小事件的相关性推断受限，容易受到阈值效应的意外影响。

然后，挑战的另一个方面出现了：我们如何使这种具体分析在各种基金之间可比较，以便全面了解投资组合的风险？投资组合可能包含数百种投资线。其风险可能是由于某个具有过大权重的特定投资的暴涨，或者更严重的是，由于投资组合的大部分资金意外损失，我们可以称之为*消失的多元化*，在某种特定事件中。

解决方案是对投资组合中所有基金进行彻底的因子分析，具有两个重要特征：

1.  1.

    每个风险因素都应该针对投资组合中的*所有*基金进行测试。

1.  2.

    应该强调大事件，以预测可预测的相关性突破。

*多模型*方法自然而然地成为这个问题的唯一可能解决方案。传统的多因素分析首先寻求每个基金的一组相关因素，然后评估每个因素及其“影响系数”（*因子载荷*）的重要性。相关性破裂和制度变化通常是分开处理的，而且往往是以非常基本的方式，很少以系统性方式处理。相反，*多模型*方法首先考虑每个单一因素对投资组合所有组成部分的影响，通过非线性模型考虑系统性相关性破裂，然后，只有在这样做之后，才汇总单一因素信息以回答诸如全局投资组合风险或投资组合中特定行的贡献等问题。

这种分析可以被视为一个巨大的自动压力测试生成器。与其将每个基金和整个投资组合都描述为由风险因素组合而成的代理，不如通过其对所有这些压力测试的响应列表来表示每个资产、每个基金和投资组合本身，每个测试都由因子变化来标识。例如，消失的分散风险效应特别容易预见，因为我们知道，在利率突然上涨的情况下，所有资产类别都会受到影响：股票、信用利差等。

我们知道，没有统计方法能摆脱其基于过去的事实，而未来对我们来说充满了意外。但是*多模型*留给意外的余地明显比传统的线性多因素分析留下的余地要小得多。

在成功将*多模型*方法应用于对冲基金投资组合之后，2007年次级房贷危机和2008年全球金融危机等重大危机显然表明，这种非线性方法不仅适用于对冲基金领域，而且适用于整个投资领域：流动性投资（股票、固定收益、衍生品等）、私募股权、房地产等。我们还发现，除了简单的风险/回报分析之外，*多模型*的丰富性还使我们能够回答更广泛的问题，如经理在流动性危机中的预期行为、策略和风格漂移、宏观经济条件对金融市场的影响、危机预测等。本书包含了解决其中几个问题的方法。

制度变化和相关性破裂经常发生在重大事件发生时。在我们看来，一个健全的数学模型必须包括任何观察到的系统性现象。简言之，数学应该符合现实，而不是相反。在这方面，像任何其他人工智能方法一样，*多模型*首先寻求为经验问题带来有效解决方案。

现在这本书的组织结构自然而然地来源于这个目标，因为它围绕着解决实证问题的想法而构建。由于金融的最通用问题是对金融市场的预测，这是我们选择解决的问题。

因此，我们提出了一个投资于股市的投资组合收益的简单模型，将其分解为市场、行业和特定收益。我们使用各种技术对这三个不同的组成部分进行预测，所有这些技术都基于多模型的非线性建模。实证应用还包括对多模型理论的理论介绍，并提出了解决其引发的各种挑战的实用解决方案。最后，我们通过遗传算法对预测进行聚合，并通过交易策略的模拟来评估组合的预测能力。在交易成本之后，获得的投资组合达到了市场的两倍以上的夏普比率。

尽管本书的主要目标是支持博士论文，但在撰写过程中，很明显它的兴趣远远超出了这个目的。本书旨在提供应用，并同时以*多模型*的自包含理论呈现为基础，这使得它成为了一个通过人工智能探索金融市场的成套手册。对于从业者来说，这是一本合适的手册，因为它提出了解决现实问题的新颖而具体的解决方案。因此，本书将对寻找新的预测算法的机器学习者，寻找原始策略的量化交易员，试图避免回撤的风险经理，以及处理多种交易策略组合问题的投资组合经理感兴趣。

我们要感谢几位对本书做出贡献的人。

+   Charles-Albert Lehalle 和 Yuri Kabanov 对整本书进行了出色的评论，从而在各种统计和机器学习方面进行了改进。

+   Augustin Landier 在因子投资相关问题上提供了精辟的观点，更广泛地涉及了金融经济学。

+   Jean-Philippe Bouchaud，Jean-Paul Laurent 和 Alexander Lipton 在其首次公开展示期间对手稿提出了一些巧妙的改进意见。

+   纳西姆·塔勒布，纽约州立大学石溪分校的量化金融团队（特别是罗伯特·弗雷和安德鲁·穆尔豪普特），Riskdata研究团队，Igmar Adlerberg，Bertrand Cabrit，Iliya Zovko，Cyril Coste，相信我们的对冲基金经理，Bernad Lozé，Jeffrey Tarrant，以及 Adil Abdulali，Bruno Dupire，Marco Avellaneda，Emmanuel Derman，Dominique Guégan，Shivaji Rao，所有实际风险研究所成员，以及 Hector Chan，Gavin Chan，Olivier Parent-Colombel，AXA IM Chorus 的 Pierre-Emmanuel Juillard 分享了富有成效的讨论和见解。

+   Aurelien Vallée 和 Omar Masmoudi 在开发书中各种应用所需的代码以及处理大型机群进行计算方面提供了极大的帮助。

+   最后，我们感谢索邦经济学中心（CES）的物质支持，并感谢我们与该中心成员进行的讨论。

Thomas Barrau Raphael Douady 香港，中国香港 香港 特别行政区 巴黎，法国 目录 [1 引言](519851_1_En_1_Chapter.xhtml) 1 [1.​1 金融市场预测：简明文献综述](519851_1_En_1_Chapter.xhtml#Sec1) 1 [1.​2 投资组合收益的简单模型](519851_1_En_1_Chapter.xhtml#Sec2) 3 [1.​3 本书的计划](519851_1_En_1_Chapter.xhtml#Sec3) 5 [参考文献](519851_1_En_1_Chapter.xhtml#Bib1) 6 [2 多模型理论：概述](519851_1_En_2_Chapter.xhtml) 9 [2.​1 引言](519851_1_En_2_Chapter.xhtml#Sec1) 9 [2.​2 数学公式](519851_1_En_2_Chapter.xhtml#Sec2) 14 [2.​3 认识论基础](519851_1_En_2_Chapter.xhtml#Sec3) 14 [2.​3.​1 统计透视主义](519851_1_En_2_Chapter.xhtml#Sec4) 15 [2.​3.​2 现象学方法](519851_1_En_2_Chapter.xhtml#Sec5) 15 [2.​4 多模型与多变量模型的比较](519851_1_En_2_Chapter.xhtml#Sec6) 16 [2.​4.​1 减少过度拟合](519851_1_En_2_Chapter.xhtml#Sec7) 16 [2.​4.​2 增加精确性](519851_1_En_2_Chapter.xhtml#Sec8) 24 [2.​4.​3 增强鲁棒性](519851_1_En_2_Chapter.xhtml#Sec9) 26 [2.​5 多模型引发的考虑](519851_1_En_2_Chapter.xhtml#Sec10) 29 [2.​5.​1 预测的聚合](519851_1_En_2_Chapter.xhtml#Sec11) 29 [2.​5.​2 每个基本模型的变量数量](519851_1_En_2_Chapter.xhtml#Sec12) 30 [2.​6 结论](519851_1_En_2_Chapter.xhtml#Sec13) 30 [参考文献](519851_1_En_2_Chapter.xhtml#Bib1) 31 [3 估计方法：线性非线性混合模型](519851_1_En_3_Chapter.xhtml) 35 [3.​1 引言](519851_1_En_3_Chapter.xhtml#Sec1) 35 [3.​2 LNLM 模型介绍](519851_1_En_3_Chapter.xhtml#Sec2) 37 [3.​2.​1 定义](519851_1_En_3_Chapter.xhtml#Sec3) 37 [3.​2.​2 拟合过程](519851_1_En_3_Chapter.xhtml#Sec4) 39 [3.​3 评价方法](519851_1_En_3_Chapter.xhtml#Sec5) 42 [3.​4 结果](519851_1_En_3_Chapter.xhtml#Sec6) 46 [3.​4.​1 对于 126 个观察结果](519851_1_En_3_Chapter.xhtml#Sec7) 48 [3.​4.​2 对于 252 个观察结果](519851_1_En_3_Chapter.xhtml#Sec8) 49 [3.​4.​3 对于 756 个观察结果](519851_1_En_3_Chapter.xhtml#Sec9) 51 [3.​4.​4 对于 1,260 个观察结果](519851_1_En_3_Chapter.xhtml#Sec10) 53 [3.​4.​5 计算时间](519851_1_En_3_Chapter.xhtml#Sec11) 55 [3.​4.​6 解释](519851_1_En_3_Chapter.xhtml#Sec12) 55 [3.​5 结论](519851_1_En_3_Chapter.xhtml#Sec13) 56 [参考文献](519851_1_En_3_Chapter.xhtml#Bib1) 57 [4 市场回报预测](519851_1_En_4_Chapter.xhtml) 59 [4.​1 引言](519851_1_En_4_Chapter.xhtml#Sec1) 59 [4.​2 数据](519851_1_En_4_Chapter.xhtml#Sec2) 61 [4.​3 系统风险指标](519851_1_En_4_Chapter.xhtml#Sec3) 64 [4.​3.​1 模型估计](519851_1_En_4_Chapter.xhtml#Sec4) 64 [4.​3.​2 系统风险指标定义](519851_1_En_4_Chapter.xhtml#Sec5) 64 [4.​3.​3 主要分析](519851_1_En_4_Chapter.xhtml#Sec6) 66 [4.​3.​4 预测能力的根源](519851_1_En_4_Chapter.xhtml#Sec7) 70 [4.​4 交易策略](519851_1_En_4_Chapter.xhtml#Sec8) 71 [4.​4.​1 方法](519851_1_En_4_Chapter.xhtml#Sec9) 72 [4.​4.​2 结果](519851_1_En_4_Chapter.xhtml#Sec10) 72 [4.​5 鲁棒性测试](519851_1_En_4_Chapter.xhtml#Sec11) 74 [4.​5.​1 对噪声过滤器的敏感性](519851_1_En_4_Chapter.xhtml#Sec12) 74 [4.
