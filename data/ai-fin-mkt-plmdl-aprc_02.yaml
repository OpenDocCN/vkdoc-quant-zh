- en: © The Author(s), under exclusive license to Springer Nature Switzerland AG 2022T.
    Barrau, R. DouadyArtificial Intelligence for Financial MarketsFinancial Mathematics
    and Fintech[https://doi.org/10.1007/978-3-030-97319-3_2](https://doi.org/10.1007/978-3-030-97319-3_2)
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: © 作者，独家许可给 Springer Nature Switzerland AG 2022T. Barrau, R. Douady 金融市场的人工智能
    金融数学和金融科技[https://doi.org/10.1007/978-3-030-97319-3_2](https://doi.org/10.1007/978-3-030-97319-3_2)
- en: '2. Polymodel Theory: An Overview'
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2. 多模型理论：概述
- en: Thomas Barrau^([1](#Aff5)  ) and Raphael Douady^([2](#Aff6))(1)AXA Investment
    Managers Chorus Ltd, Hong Kong, Hong Kong S.A.R.(2)Economic Center, University
    Paris 1 Sorbonne, Paris, France
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Thomas Barrau^([1](#Aff5)  ) 和 Raphael Douady^([2](#Aff6))(1)AXA 投资经理 Chorus
    Ltd，香港，中国香港特别行政区(2)巴黎索邦大学经济中心，法国巴黎
- en: Abstract
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: We present Polymodel Theory, defining a polymodel as a *collection of non-linear
    univariate models*. A mathematical formulation as well as an epistemological foundation
    is presented. We explain how polymodels are, in several respects, a superior alternative
    to classical multivariate regressions estimated with OLS, Ridge and Stepwise techniques;
    we also present the limits of the method. Although it is a regression technique,
    we clarify how the polymodels framework is closer to artificial intelligence than
    traditional statistics.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们提出了多模型理论，将多模型定义为*一组非线性单变量模型*。我们提出了数学公式和认识基础。我们解释了多模型在几个方面是传统OLS、岭回归和逐步回归等估计的多元回归的一个优越替代；我们还介绍了这种方法的局限性。尽管它是一种回归技术，但我们阐明了多模型框架如何比传统统计学更接近人工智能。
- en: KeywordsPolymodel theoryArtificial intelligenceMachine learningUnivariate regressionMultivariate
    regressionNon-linear modelingHigh dimension modelingOverfitting
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 关键词多模型理论人工智能机器学习单变量回归多元回归非线性建模高维建模过拟合
- en: 2.1 Introduction
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.1 引言
- en: Polymodels, understood as *a collection of non-linear univariate models*, were
    introduced in finance by Coste et al. ([2010](#CR13)). In their paper, polymodels
    are used as a part of an overall procedure to predict hedge fund performance.
    The concept, albeit fairly general, is thus presented concisely, since the paper
    aims to focus on the results of its applications. The purpose of the current chapter
    is therefore to provide a more in-depth discussion on the theory of polymodels,
    in order to understand the pros and cons of this technique, along with the possibilities
    of the framework it offers.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 多模型，理解为*一组非线性单变量模型*，是由 Coste 等人([2010](#CR13)) 在金融领域引入的。在他们的论文中，多模型被用作预测对冲基金绩效的整体程序的一部分。因此，尽管概念相当通用，但论文以简洁方式呈现，因为其目的是专注于其应用结果。因此，当前章节的目的是更深入地讨论多模型理论，以便了解这种技术的利弊，以及其提供的框架的可能性。
- en: The use of a collection of univariate models must be understood as an alternative
    to the use of a multivariate regression model. The interest of polymodels is thus
    explained extensively, from this perspective, in the current chapter. However,
    the way we approach modeling through polymodels somehow differs from the standard
    perspective of statistics, as it is closer to artificial intelligence. For the
    reader to follow the standpoint we propose, we need to go back to the question
    of the purpose of modeling.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 一组单变量模型的使用必须被理解为对多元回归模型的一种替代。因此，从这个角度来看，多模型的利益在当前章节中得到了广泛解释。然而，我们通过多模型来处理建模的方式在某种程度上与统计学的标准视角有所不同，因为它更接近人工智能。为了让读者理解我们提出的观点，我们需要回到建模目的的问题。
- en: For Aris ([1994](#CR3)), “a system of equations, Σ, is said to be a model of
    the prototypical system, S, if it is formulated to express the laws of S and its
    solution is intended to represent some aspect of the behavior of S”. This quite
    static definition is complemented by Davis et al. ([2011](#CR14)), who propose
    a list of the purposes for which models are constructed, including among others
    “to influence further experimentation or observation”. This last goal is the key
    to understanding our position. As it has been designed to tackle problems encountered
    in finance, Polymodel Theory belongs to the field of applied mathematics, since
    our focus is on “mathematics that finds applications outside of its own interest”
    (see Davis et al. ([2011](#CR14)) again for this definition). Polymodels are a
    tool developed not only to observe and represent (some sub-parts of) the financial
    system, but also with the goal of acting as practitioners, traders and risk managers
    that are a part of it, thus modifying the system. Fundamentally, our approach
    to modeling is thus oriented by the pursuit of effective results while acting
    in the real world.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 对于阿里斯（[1994](#CR3)），“一个方程组Σ被称为是典型系统S的模型，如果它被构建来表达S的定律，并且其解决方案意图代表S行为的某个方面”。这个相当静态的定义被戴维斯等人（[2011](#CR14)）补充，他们提出了模型被构建的目的列表，其中包括“影响进一步的实验或观察”。这个最后的目标是理解我们立场的关键。由于它被设计来解决金融领域遇到的问题，Polymodel理论属于应用数学领域，因为我们的重点是“找到应用于自身利益之外的数学”（参见戴维斯等人([2011](#CR14)）再次说明这个定义）。Polymodels不仅是一个观察和表示（金融系统的某些子部分）的工具，还旨在作为其中的从业人员、交易员和风险管理人员，从而改变系统。基本上，我们对建模的方法是通过追求在现实世界中行动时产生有效结果来导向的。
- en: 'This objective being stated, we suggest below a simplified, caricature version
    of the modeling process. This representation is not intended to describe the process
    that each researcher follows, nor to outline a methodological standard; it simply
    offers some support to the presentation of our approach to modeling. We start
    with the problem of having one (or several) variable(s) of interest, that are
    (partly) random, and for which we would like to produce some predictions, within
    an environment itself composed of random variables. Let us call our variable of
    interest *Y*, and the set of the variables that compose the environment *X*. We
    may then follow the stylized process:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '有了这个目标，我们在下面提出了建模过程的简化、漫画版本。这个表示不打算描述每个研究者遵循的过程，也不是要勾勒出一个方法标准；它只是为了支持我们对建模方法的介绍。我们从拥有一个（或多个）感兴趣的变量的问题开始，这些变量是（部分）随机的，并且我们希望在一个由随机变量组成的环境中进行一些预测。让我们称我们感兴趣的变量为*Y*，组成环境的变量集合为*X*。然后我们可以遵循这个程式化的过程： '
- en: 'Step A: the researcher formulates a proposition of a model of the variable
    of interest, as a conditional expectation of its environment. The purpose of this
    step is to model the links between *Y* and *X*:'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 步骤A：研究者制定感兴趣变量的模型命题，作为其环境条件期望。此步骤的目的是对*Y*和*X*之间的联系建模：
- en: '![$$ E\left[Y|X\right]=f(X). $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ1.png)(2.1)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![$$ E\left[Y|X\right]=f(X). $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ1.png)(2.1)'
- en: 'This step, which may be very complex, can involve a discussion of the definition
    of *Y* and *X*, and the development of some sophisticated versions of *f* ().
    For example, it may include some dynamical representations if *Y* is a random
    process:'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这一步骤可能非常复杂，可能涉及对*Y*和*X*的定义讨论，以及一些复杂版本的*f*()的开发。例如，如果*Y*是一个随机过程，它可能包括一些动态表示：
- en: '![$$ E\left[{Y}_t\ |\ {\left\{{X}_s\right\}}_{s\in \left[t-\tau :t\right]}\right]=f\left({X}_t,{X}_{t-1},{X}_{t-2},\dots
    \right). $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ2.png)(2.2)*Here
    “t” is the current time index, “τ” is the farthest significant time-lag of X,
    and “s” is the second time index defined between t−τ and t.*'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '![$$ E\left[{Y}_t\ |\ {\left\{{X}_s\right\}}_{s\in \left[t-\tau :t\right]}\right]=f\left({X}_t,{X}_{t-1},{X}_{t-2},\dots
    \right). $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ2.png)(2.2)*这里的“t”是当前时间索引，“τ”是X的最远重要时间滞后，“s”是定义在t−τ和t之间的第二个时间索引。*'
- en: 'Step B: the statistical properties of the model are studied. This step may
    include a study of the distribution of the variable of interest *Y* and of the
    joint distribution of the environment variables *X*, but also a study of the distribution
    of the parameters of the model *f* (), in order to quantify their uncertainty,
    assess their robustness, etc.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二步：研究模型的统计特性。这一步骤可能包括研究感兴趣变量*Y*的分布以及环境变量*X*的联合分布，但也可能包括研究模型参数*f*()的分布，以量化其不确定性、评估其鲁棒性等。
- en: 'Step C: the model is used for a particular purpose. This may be the maximization
    of a given utility function, or the estimation of a risk measure, or any kind
    of goal that allows one to make a decision.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三步：将模型用于特定目的。这可能是最大化给定效用函数，或者估计风险度量，或者任何能够帮助做出决策的目标。
- en: 'Step D: the best models produced by steps A to C are selected. The variables
    they include, the functional forms they use, and the methods they employ are evaluated
    using performance and relevance measures, such as the *p*-value.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第四步：选择由步骤A到C产生的最佳模型。评估它们包含的变量、使用的函数形式以及采用的方法，使用性能和相关性度量，例如*p*-值。
- en: Some form of stress-testing of the models (for example using Monte-Carlo simulations)
    may be introduced either in step C as a validation of the model, or in step D
    as a selection criterion.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在第三步引入对模型的某种形式的应力测试（例如使用蒙特卡洛模拟），作为模型验证的一部分，或者在第四步作为选择标准。
- en: Since we model in order to act, our focus is entirely on the results obtained
    in step C.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们建模以行动，我们的重点完全放在步骤C中获得的结果上。
- en: Individual researchers often focus on step A to C, while D may be considered
    as a meta-problem which is related to how the literature evolves on a given topic.
    When performing a polymodel analysis, the steps are completed in a different manner.
    We first estimate a collection of univariate models, which corresponds to a repetition
    of step A. We then select the best models, which corresponds to step D, using
    criteria intentionally defined regarding the objective of step C. Step D itself
    is repeated, as we use it to consider the dynamic evolution of the collection
    of models through time. We primarily keep the information obtained in a multidimensional
    form, which allows us to derive a variety of indicators (e.g. the StressVaR (Coste
    et al. ([2010](#CR13))), or the Long-term Expectation (Guan, [2019](#CR20))).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 个别研究人员通常关注步骤A到C，而D可能被视为与文献在给定主题上的演变相关的元问题。在执行多模型分析时，步骤以不同的方式完成。我们首先估计一组单变量模型，这对应于步骤A的重复。然后，我们使用有意义地与步骤C的目标相关的标准选择最佳模型，这对应于步骤D。步骤D本身是重复的，因为我们将其用于考虑模型集合随时间的动态演变。我们主要以多维形式保留所获得的信息，这使我们能够导出各种指标（例如StressVaR
    (Coste等人([2010](#CR13)))或Long-term Expectation (Guan，[2019](#CR20))）。
- en: We perform step A repeatedly in an imprecise, simplified, and sub-optimal manner,
    but the multiplicity of models overcome this simplification since the collection
    of models is a very rich representation of the phenomenon we are studying. Let
    us take a toy example to clarify this point. We can model the returns of the S&P
    500 by a collection of non-linear univariate models obtained from financial variables.
    Often, we assume the noise of the model to be Gaussian, which is of course quite
    simplistic, knowing that financial markets have fatter tails (see e.g. Platen
    and Rendek ([2008](#CR31)) on this point). However, the non-linear modeling of
    oil, for example, may be able to partly capture the tail events of the S&P. And
    for a high number of independent variables in the factor set, it is likely that
    the non-linear modeling captures the tail events at some point (see Ye & Douady,
    ([2019](#CR44)) for an example of market drawdown prediction using polymodels).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们以不精确、简化和次优的方式重复执行步骤A，但由于模型的多样性，这种简化被克服，因为模型集合是我们所研究现象的非常丰富的表示。让我们通过一个简单的例子来澄清这一点。我们可以用从金融变量获得的非线性单变量模型集合来模拟标准普尔500的回报。通常，我们假设模型的噪声是高斯的，这当然是相当简化的，知道金融市场的尾部更厚（参见例如Platen和Rendek
    ([2008](#CR31))）。然而，例如，对油的非线性建模可能能够在某种程度上捕捉标准普尔500的尾部事件。而且对于因子集中的大量独立变量，非线性建模很可能在某个时候捕捉到尾部事件（例如，参见Ye
    & Douady，([2019](#CR44))，以获取使用多模型进行市场回撤预测的示例）。
- en: Questions about the robustness of the methods still need to be asked, but in
    a way that differs from the stylized research process presented above. Since we
    are entirely focused on achieving results in regard to step C, part of the work
    usually done in step B may become irrelevant. For example, we can observe that
    there is no particular reason for the transition from step B to C to be linear,
    it may even be highly non-linear in most of the cases. Following this reasoning,
    the quest for unbiased estimators becomes irrelevant, since they can’t be used
    effectively to reach to final objective of step C. Hence, the robustness of the
    results obtained from the polymodel approach is often assessed through sensitivity
    analysis, or particular tests developed to measure the statistical significance
    of the results (see Chaps. [4](519851_1_En_4_Chapter.xhtml), [5](519851_1_En_5_Chapter.xhtml)
    and [6](519851_1_En_6_Chapter.xhtml) of the present book). We thus do not discuss
    the problems addressed by step B, as although they are interesting by themselves,
    they are of secondary importance when considering step C as a central concern.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 仍然需要问关于方法鲁棒性的问题，但方式与上述的程式化研究过程有所不同。由于我们完全专注于实现关于步骤C的结果，通常在步骤B中完成的部分工作可能变得无关紧要。例如，我们可以观察到，从步骤B到C的过渡没有特定的原因，它甚至在大多数情况下可能是高度非线性的。按照这种推理，追求无偏估计变得无关紧要，因为它们不能有效地用于实现步骤C的最终目标。因此，通过敏感性分析或特定测试来评估多模型方法得到的结果的鲁棒性经常是通过统计显著性（见本书第[4](519851_1_En_4_Chapter.xhtml)、[5](519851_1_En_5_Chapter.xhtml)和[6](519851_1_En_6_Chapter.xhtml)章）的测量来进行的。因此，我们不讨论步骤B所解决的问题，尽管它们本身很有趣，但在考虑到将步骤C作为中心关注时，它们是次要的。
- en: 'Note that apart from polymodels, another research field performs steps A and
    D directly regarding the objective of step C: machine learning (Friedman et al.,
    ([2001](#CR18)) provide a long introduction to the main techniques). From this
    perspective, polymodels could be considered as a machine learning technique.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，除了多模型之外，另一个研究领域直接执行步骤A和D，关于步骤C的目标：机器学习（Friedman等人，（[2001](#CR18)）提供了对主要技术的长篇介绍）。从这个角度来看，多模型可以被视为一种机器学习技术。
- en: 'Now that once the breadcrumb of the modeling approach of Polymodel Theory has
    been established, we can develop several points that will further clarify the
    concept. In order to do so, we organize the chapter as follows:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，一旦建立了多模型理论建模方法的面包屑，我们可以发展几个进一步澄清概念的要点。为此，我们将本章组织如下：
- en: As a final part of the introduction, we first review the current state of the
    literature on the topic of polymodels.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 作为介绍的最后部分，我们首先回顾了有关多模型主题的文献的当前研究状况。
- en: We then formally define the notion of polymodel.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后我们正式定义了多模型的概念。
- en: This definition is followed by a discussion on how this object can be interpreted
    from an epistemological point of view.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这一定义之后，我们讨论了如何从认识论角度解释这个对象。
- en: We then review the most salient advantages that are expected when using the
    technique, in econometrical terms. The use of a collection of univariate models
    is an alternative to the use of a multivariate model. We thus discuss these advantages
    with regard to standard alternatives, such as the classical linear regression
    estimated by OLS, Ridge regression, or Stepwise regression.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后，我们回顾了在计量经济学术语中使用该技术时所期望的最显著优势。使用一系列单变量模型是使用多变量模型的一种替代方法。因此，我们将这些优势与标准替代方案进行讨论，例如由OLS估计的经典线性回归，岭回归或逐步回归。
- en: We finally consider the challenges that Polymodel Theory raises, and conclude
    the chapter.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们考虑了多模型理论所引发的挑战，并总结了本章。
- en: 'Some of the important questions that are raised when using polymodels in practice
    are:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中使用多模型时引发的一些重要问题是：
- en: How do we estimate the univariate models?
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们如何估计单变量模型？
- en: How do we select the variables?
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们如何选择变量？
- en: How do we aggregate the results?
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们如何合并结果？
- en: The current chapter only proposes a theoretical overview of Polymodel Theory,
    and thus provides answers to the questions “what is a polymodel?” and “why using
    it?” but not to the question “how to use it?”. The three practical questions listed
    above, which simply develop the more general question “how to use it?”, may be
    approached in very different ways, that must be adapted to the empirical problem
    being tackled. Hence, presenting any of the techniques that we can use to answer
    these questions would cause the current chapter to lack generality. We thus restrict
    our explanations to the objective of presenting the notion of polymodels.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当前章节只是提出了 Polymodel 理论的理论概述，因此回答了“什么是 polymodel？”和“为什么使用它？”的问题，但没有回答“如何使用它？”的问题。上述三个简单发展更一般问题“如何使用它？”的实际问题可能会以非常不同的方式来解决，必须根据所处理的经验问题进行调整。因此，介绍我们可以用来回答这些问题的任何技术都会导致当前章节缺乏普遍性。因此，我们将限制我们的解释以呈现
    polymodel 的概念。
- en: The literature on Polymodel Theory is still scarce. In its current form, there
    have been applications in finance, however the usage of collections of univariate
    linear models also exists outside of this field.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Polymodel 理论的文献仍然很稀少。目前的形式已经在金融领域有了应用，但是单变量线性模型集合的使用也存在于这个领域之外。
- en: 'We first review the emerging financial literature on this topic. Apart from
    the initial paper of Coste et al. ([2010](#CR13)), which introduces the notion,
    Polymodel Theory has already been used in a variety of applications in finance:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先回顾了关于这个主题的新兴金融文献。除了 Coste 等人 ([2010](#CR13)) 的初始论文介绍了这个概念之外，Polymodel 理论已经在金融领域的各种应用中得到了使用：
- en: Zhang ([2019](#CR45)) built a clustering algorithm based on polymodel estimations,
    with applications to the equity market. The overall idea is that if two stocks
    react in the same manner to different factors, they are somehow similar. The clustering
    algorithm is used to design a statistical arbitrage trading strategy that delivers
    superior returns compared to the benchmark. The clustering algorithm is shown
    to outperform classic clustering methods (correlations, qualitative classification)
    in the context of statistical arbitrage.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 张 ([2019](#CR45)) 基于 polymodel 估计构建了一个聚类算法，并应用于股票市场。总体思想是，如果两只股票对不同因素的反应方式相同，它们在某种程度上是相似的。聚类算法被用来设计一种比基准表现更好的统计套利交易策略。聚类算法在统计套利的背景下表现出色，超越了经典的聚类方法（相关性、定性分类）。
- en: Ye and Douady ([2019](#CR44)), and Kuang and Douady ([2022](#CR2001)) proposed
    some systemic risk indicators for equity indices based on polymodels. The indicators
    are essentially focused on the increase of the statistical significance of the
    links of a factor set with a stock index (Ye & Douady) and the concavity of the
    elementary models (Kuang & Douady).
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 叶和杜亚迪 ([2019](#CR44))，以及匡和杜亚迪 ([2022](#CR2001)) 提出了一些基于 polymodel 的股票指数系统风险指标。这些指标主要关注因子集与股票指数之间联系的统计显著性增加（叶
    & 杜亚迪）和基本模型的凹性（匡 & 杜亚迪）。
- en: Guan ([2019](#CR20)) used polymodels to produce some variations of traditional
    risk premia. He proved that the StressVaR, which is the risk indicator tested
    by Coste et al. ([2010](#CR13)) for distinguishing risky hedge funds, is also
    a useful predictor of the cross-section of stock returns.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关 ([2019](#CR20)) 使用 polymodel 生成了一些传统风险溢价的变体。他证明了 StressVaR，这是 Coste 等人 ([2010](#CR13))
    用于区分风险对冲基金的风险指标，也是股票收益横截面的一个有用预测因子。
- en: 'The literature on Polymodel Theory is thus still sparse, which justifies our
    proposal for a denser discussion of this framework of analysis.Constructing a
    set of univariate models is quite an intuitive approach to modeling when the amount
    of data is too large to handle, a case in which a multivariate linear regression
    can bear some limitations. Indeed, having an uninvertible covariance matrix of
    predictors because there are more predictors than observations, or finding problems
    of multicollinearity, are concerns that are not confined to finance. Unsurprisingly,
    some traces and precedents of Polymodel Theory have been found in several disciplines:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: Polymodel 理论的文献仍然稀少，这正好说明了我们提出对这种分析框架进行更密集讨论的建议。当数据量过大无法处理时，构建一组单变量模型是一种相当直观的建模方法，这种情况下多元线性回归可能会有一些限制。的确，由于预测变量的协方差矩阵不可逆（因为预测变量多于观测值），或者出现多重共线性问题，这些问题并不局限于金融领域。毫不奇怪，Polymodel
    理论的一些迹象和先例已经在几个学科中找到：
- en: In genetics, the field of Genome-Wide Association Studies (GWAS) massively relied
    on linear versions of polymodels. GWAS encountered the problem of dealing with
    hundreds of thousands of predictors to predict a single target variable. Furthermore,
    there are more independent variables than observations. Classical regularization
    techniques have been used in an attempt to solve the problem of correlation among
    predictors, e.g. see de Vlaming and Groenen ([2015](#CR15)) for Ridge regressions,
    Wu et al. ([2009](#CR43)) for Lasso, or Liang and Kelemen ([2008](#CR27)) for
    a literature review.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在遗传学中，基因组范围关联研究（GWAS）领域大量依赖于Polymodels的线性版本。GWAS面临的问题是要处理数十万个预测变量来预测单个目标变量。此外，独立变量比观测值更多。经典的正则化技术已被用来尝试解决预测变量之间的相关性问题，例如参见de
    Vlaming和Groenen（[2015](#CR15)）的Ridge回归，Wu等人（[2009](#CR43)）的Lasso，或Liang和Kelemen（[2008](#CR27)）的文献综述。
- en: In an analysis of driver fatality risk factors, Bose et al. ([2013](#CR7)) used
    a set of univariate models to benchmark the coefficients obtained with a multivariate
    model.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在对驾驶员致命风险因素进行分析时，Bose等人（[2013](#CR7)）使用一组单变量模型来对多变量模型得到的系数进行基准测试。
- en: For the purpose of analysing epidemics, Bessell et al. ([2010](#CR6)) began
    their study with a set of univariate models. They used the results of this polymodel
    to assess the statistical significance of the predictors, in order to select the
    most relevant of them to build a multivariate model.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了分析流行病，Bessell等人（[2010](#CR6)）从一组单变量模型开始他们的研究。他们利用这个多模型的结果来评估预测变量的统计显著性，以选择最相关的变量来构建多变量模型。
- en: Ladyzhets ([2019](#CR26)) proposed to analyse the probability space of a set
    of regression models to model financial time series. Although close to polymodels,
    as it represents the target variable using alternative models, the paper still
    uses multivariate models, thus losing some of the benefits of the former.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ladyzhets（[2019](#CR26)）建议分析一组回归模型的概率空间来建模金融时间序列。虽然与Polymodels接近，因为它使用替代模型表示目标变量，但该论文仍然使用多元模型，从而失去了前者的一些好处。
- en: These last examples do not directly refer to Polymodel Theory as we present
    it in the current chapter, however, they show that the concerns we encounter when
    using multivariate regressions techniques are shared among several fields, making
    polymodels potentially interesting for mathematical applications outside of finance.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这些最后的例子并没有直接涉及到我们在当前章节中提出的Polymodel理论，然而，它们表明了在使用多元回归技术时我们遇到的关注点是多个领域共享的，使得Polymodels在金融之外的数学应用中可能是有趣的。
- en: 2.2 Mathematical Formulation
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.2 数学公式化
- en: A polymodel can be defined as a collection of models, all equally valid and
    significant, that can be understood as a collection of relevant points of view
    on the same reality.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一个Polymodel可以被定义为一组模型，它们都同样有效和显著，可以被理解为对同一现实的一系列相关观点的集合。
- en: Mathematically, it can be equally formalized using Eq. ([2.3](#Equ3)) or Eq.
    ([2.4](#Equ4)):![$$ \left\{\begin{array}{c}Y={\varphi}_1\left({X}_1\right)\\ {}Y={\varphi}_2\left({X}_2\right)\\
    {}\dots \\ {}Y={\varphi}_n\left({X}_n\right)\end{array}\right. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ3.png)(2.3)![$$
    \left\{Y={\varphi}_i\left({X}_i\right)\kern1em \forall i\right\}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ4.png)(2.4)*Here,
    Y is the target variable, X*[*i*] *and* φ[i] *are respectively the explanatory
    variable and the function of the i*^(*th*) *model, with i ϵ[1: n], and n the number
    of models (and factors).*
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 从数学上讲，可以用方程（[2.3](#Equ3)）或方程（[2.4](#Equ4)）等式来等效地形式化：![$$ \left\{\begin{array}{c}Y={\varphi}_1\left({X}_1\right)\\
    {}Y={\varphi}_2\left({X}_2\right)\\ {}\dots \\ {}Y={\varphi}_n\left({X}_n\right)\end{array}\right.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ3.png)(2.3)![$$
    \left\{Y={\varphi}_i\left({X}_i\right)\kern1em \forall i\right\}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ4.png)(2.4)*这里，Y是目标变量，X[i]是解释变量，而φ[i]分别是第i个模型的函数，其中i
    ϵ[1: n]，n是模型（和因素）的数量。*
- en: The *n* models that we present here, called “elementary models”, are models
    of a single variable. These models are all defined on the entire hyperspace of
    the explanatory variables *ℝ*^(*n*). They do not interact with each other and
    they are all valid simultaneously.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里呈现的*n*个模型，称为“基本模型”，都是单变量模型。这些模型都在解释变量*ℝ*^(*n*)的整个超空间上定义。它们彼此不相互作用，并且它们同时都是有效的。
- en: The noise term *ε*[*i*] is added to represent stochastic errors:^([1](#Fn1))![$$
    \left\{\begin{array}{c}Y={\varphi}_1\left({X}_1\right)+{\varepsilon}_1\\ {}Y={\varphi}_2\left({X}_2\right)+{\varepsilon}_2\\
    {}\dots \\ {}Y={\varphi}_n\left({X}_n\right)+{\varepsilon}_{n.}\end{array}\right.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ5.png)(2.5)Similarly,
    from Eq. ([2.4](#Equ4)):![$$ \left\{Y={\varphi}_i\left({X}_i\right)+{\varepsilon}_i\kern1em
    \forall i\right\}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ6.png)(2.6)
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 噪声项*ε*[*i*]被添加以表示随机误差:^([1](#Fn1))![$$ \left\{\begin{array}{c}Y={\varphi}_1\left({X}_1\right)+{\varepsilon}_1\\
    {}Y={\varphi}_2\left({X}_2\right)+{\varepsilon}_2\\ {}\dots \\ {}Y={\varphi}_n\left({X}_n\right)+{\varepsilon}_{n.}\end{array}\right.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ5.png)(2.5)同样，从方程([2.4](#Equ4))可以得到:![$$
    \left\{Y={\varphi}_i\left({X}_i\right)+{\varepsilon}_i\kern1em \forall i\right\}.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ6.png)(2.6)
- en: 2.3 Epistemological Foundations
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3 认识论基础
- en: Polymodel Theory can be considered from many different points of view. Even
    if we present applications clearly focused on financial mathematics, it is important
    to emphasize the philosophical roots that have led to the emergence of the theory.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 多模型理论可以从许多不同的角度来考虑。即使我们明确专注于金融数学的应用，强调导致该理论出现的哲学根源也是很重要的。
- en: 2.3.1 A Statistical Perspectivism
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.1 统计视角主义
- en: The concept of perspectivism was first developed by the pre-Socratic philosopher
    Protagoras (c. 481 B.C.E.–c. 420 B.C.E.), whose thoughts we know through the dialogues
    of Plato (Lamb, [1967](#CR32); Taylor & Lee, [2016](#CR38)). Perspectivism, the
    key to understanding Polymodel Theory, claims that we can’t access a single and
    absolute truth. What we consider as true is often only true from the particular
    perspective adopted, and the formation of this perception of reality itself is
    dependent on the perspective in which it appears. It is an invitation to humbly
    understand that we are biased and have limited access and a limited understanding
    of the world.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 视角主义的概念最初由前苏格拉底哲学家普罗泰戈拉斯（约公元前481年至公元前420年）发展而来，我们通过柏拉图（Lamb，[1967](#CR32)；Taylor
    & Lee，[2016](#CR38)）的对话了解到他的思想。视角主义是理解多模型理论的关键，它声称我们无法获得单一和绝对的真理。我们认为真实的东西往往只是从特定视角来看才是真实的，而这种对现实的感知本身取决于它出现的视角。这是一个谦逊地理解我们是有偏见的，对世界的了解和接触是有限的邀请。
- en: 'One can easily understand the need to use several perspectives on the same
    question from the reflections of Pascal in his *Essay pour les coniques* (Clarke
    & Smith, [1928](#CR12)): “By the term conic section we mean the circumference
    of the circle, the ellipse, the hyperbola, the parabola and the rectilinear angle”.
    All these perspectives on the same object are true and complementary, because
    none of them is able to fully describe the nature of the cone.'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 人们可以很容易地从帕斯卡在他的《圆锥曲线论文》（Clarke & Smith，[1928](#CR12)）中的反思中理解需要在同一问题上使用几个不同视角的必要性：“通过圆锥截面这个术语，我们指的是圆周、椭圆、双曲线、抛物线和直线角”。对于同一对象的所有这些视角都是真实且互补的，因为没有一个能够完全描述圆锥的本质。
- en: Thus, in the philosophical doctrines that flow from perspectivism, reality is
    the aggregation of all the perspectives that we have on it.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在流经视角主义的哲学学说中，现实是我们对其所有视角的聚合。
- en: Similarly, the purpose of Polymodel Theory is to combine several descriptions
    of the same variable in order to get as close as possible to a full understanding
    of its nature. It provides a very rich description of reality, which is more than
    the sum of its parts, allowing us to understand very accurately some specific
    aspects of the considered variable. Hence, Polymodel Theory is a mathematical
    equivalent of philosophical perspectivism.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，多模型理论的目的是将同一变量的几个描述组合在一起，以尽可能全面地理解其本质。它提供了对现实的非常丰富的描述，这种描述不仅仅是其部分的总和，还允许我们非常准确地理解所考虑变量的一些特定方面。因此，多模型理论是哲学视角主义的数学等价物。
- en: 2.3.2 A Phenomenological Approach
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.2 现象学方法
- en: 'The different elementary models that compose the polymodel are alternative
    descriptions of its variable of interest. But these descriptions are made in a
    particular way: they describe how the dependent variable *reacts* to each independent
    variable.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 构成多模型的不同基本模型是其感兴趣变量的替代描述。但是这些描述是以一种特定的方式进行的：它们描述了依赖变量对每个自变量的*反应*。
- en: 'Phenomenology can be described as follows (Smith, [2018](#CR36)): “Literally,
    phenomenology is the study of ‘phenomena’: appearances of things, or things as
    they appear in our experience, or the ways we experience things, thus the meanings
    things have in our experience.”'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 现象学可以如下描述（Smith，[2018](#CR36)）：“字面上，现象学是对‘现象’的研究：事物的外表，或者事物在我们的经验中呈现的方式，或者我们经验事物的方式，因此事物在我们经验中具有的含义。”
- en: Thus, the point of interest of phenomenology is how the various phenomena that
    compose our experience interact with us. Polymodel Theory proposes a similar approach,
    by studying how various independent variables (i.e. an environment) interact with
    a variable of interest.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，现象学的焦点是我们的经验中组成的各种现象如何与我们互动。Polymodel 理论提出了类似的方法，通过研究各种独立变量（即环境）如何与感兴趣的变量互动来实现。
- en: Such a position is by itself extremely meaningful, because it states that there
    is no interest given to the underlying mechanism of the dependent variable. A
    polymodel just describes how this variable behaves in various situations, that
    are as complete as the set of explanatory variables is. It does not explain why
    this behavior occurs, although it can help us to understand it. Hence, Polymodel
    Theory is closer to the physicist’s approach to studying reality than to the economist’s
    approach, as it primarily answers the question “how?” instead of the question
    “why?”.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这样的立场本身就非常有意义，因为它指出对于因变量的底层机制没有兴趣。Polymodel 只是描述了这个变量在各种情况下的行为，这些情况与解释变量的集合一样完整。它并不解释为什么会发生这种行为，尽管它可以帮助我们理解它。因此，Polymodel
    理论更接近于物理学家研究现实的方法，而不是经济学家的方法，因为它主要回答的问题是“怎么样？”而不是“为什么？”。
- en: 2.4 Comparison of Polymodels to Multivariate Models
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.4 Polymodels 与多变量模型的比较
- en: 2.4.1 Reducing Overfitting
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.1 减少过度拟合
- en: Econometric models usually admit two components, a deterministic component,
    often called the mean equation, and a stochastic component, called the error term
    (see the introductions to econometrics by Stock and Watson ([2015](#CR37)) and
    Seber and Lee ([2012](#CR34)), or Alexopoulos ([2010](#CR2)) for a concise paper
    about multivariate regression):![$$ Y=f(X)+\varepsilon . $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ7.png)(2.7)Here
    *Y* is the random variable of interest that we would like to explain, *f(X)* is
    the mean equation composed of a set of random variables *X* and a function *f*
    () that produces the association between *Y* and *X*, and ε is the error term,
    which follows some probability law usually centered at 0\. When the set of random
    variables *X* contains only one variable, the model is called “univariate”, while
    it is “multivariate” when it contains more than one variable. The division between
    deterministic (*f(X)*) and stochastic (*ε*) components is justified by the natural
    complexity of our world, in which there is usually a vast number of causes linked
    to the phenomenon that occurs, making each event partly unpredictable, simply
    because of the (current) inability of mathematical models to handle such a high
    level of complexity.This way of describing reality implies that only a part of
    the target variable’s values can be described by the predictors, while the remaining
    part cannot and must be left unexplained. Assuming that there is an effective
    link between the target variable and the predictors, the aim of modeling in our
    context is to accurately represent this relation. This should be done by constructing
    a mean equation that represents the relation of the predictors to the deterministic
    part of the target variable, using only the information about the target variables
    that is contained in the predictors. This relation is formalized by a functional
    form, which is a stylized proxy for the true relation. The simplest functional
    form to manipulate is the linear one (Stock & Watson, [2015](#CR37)):![$$ Y= X\beta
    +\varepsilon, $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ8.png)(2.8)where
    *β* is a column vector of linear coefficients, and *X* is a matrix that contains
    a vector of ones when a constant is included (we assume this is always the case
    hereafter), and the vectors of the explanatory variables.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 计量经济模型通常包括两个组成部分，一个确定性部分，通常称为均值方程，和一个随机部分，称为误差项（参见斯托克和沃森([2015](#CR37))以及塞伯和李([2012](#CR34))的计量经济学导论，或者亚历克索普洛斯([2010](#CR2))关于多元回归的简洁论文）:![$$
    Y=f(X)+\varepsilon . $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ7.png)(2.7)这里
    *Y* 是我们希望解释的随机变量，*f(X)* 是由一组随机变量 *X* 和一个函数 *f* () 组成的均值方程，该函数产生 *Y* 和 *X* 之间的关联，ε
    是误差项，通常服从于0的某种概率规律。当随机变量 *X* 的集合只包含一个变量时，该模型称为“单变量”，而当它包含多个变量时，则称为“多变量”。将确定性部分（*f(X)*）和随机部分（*ε*）之间的分离是因为我们的世界的自然复杂性，其中通常存在着与发生的现象相关的大量原因，使得每个事件部分不可预测，仅仅因为数学模型目前无法处理如此高的复杂性。这种描述现实的方式暗示了只有一部分目标变量的值可以用预测变量来描述，而其余部分则不能，并且必须保持未解释。假设目标变量与预测变量之间存在有效的联系，则我们的上下文中建模的目标是准确地表示这种关系。这应该通过构建一个表示预测变量与目标变量确定性部分之间关系的均值方程来完成，仅使用包含在预测变量中的关于目标变量的信息。这种关系由一个功能形式来形式化，它是真实关系的一种程式化代理。最简单的功能形式是线性的一个（斯托克和沃森，[2015](#CR37)):![$$
    Y= X\beta +\varepsilon, $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ8.png)(2.8)其中
    *β* 是线性系数的列向量，*X* 是一个矩阵，当包含一个常数时包含一个向量，我们假定以后都是这样。以及解释变量的向量。
- en: Given a particular sample of data, the task of the scientist is to choose a
    functional form and estimate its parameters to represent this relation. Of course,
    the goal being to explain the target variable, the importance of the deterministic
    part relative to the stochastic part^([2](#Fn2)) should be as high *as possible*
    in a good model.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 给定一组特定的数据样本，科学家的任务是选择一个功能形式并估计其参数，以表示这种关系。当然，目标是解释目标变量，良好模型中确定性部分与随机部分的重要性^([2](#Fn2))应尽可能高*。
- en: However, the truly stochastic part of the model, i.e. the part of the target
    variable’s values which is not related to the predictors, can always be spuriously
    modeled using the predictors. This is just a matter of using a sufficiently complex
    and appropriately parametrized function of the predictors. In-sample, this would
    greatly improve the usual measures of goodness of fit of the model, but in such
    a case, we would be modeling a link that does not exist since, by definition,
    there is no link between the predictors and the stochastic part of the target
    variable. Hence, after estimating the model using a particular sample of data,
    a direct consequence of this bad practice arises when new values of the predictors
    (outside of the original data set) are used to predict corresponding values of
    the target variable. The accuracy of the predictions is low, revealing the weakness
    of the initial model.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，模型中真正随机的部分，即与预测变量无关的目标变量值部分，总是可以通过预测变量虚假建模。这只是使用足够复杂和适当参数化的预测变量函数的问题。在样本内，这将极大地改善模型的常规拟合度度量，但在这种情况下，我们将对不存在的联系进行建模，因为根据定义，预测变量与目标变量的随机部分之间没有联系。因此，在使用特定数据样本估计模型之后，当使用预测变量的新值（超出原始数据集）来预测相应的目标变量值时，这种不良实践的直接后果就会出现。预测的准确度很低，揭示了初始模型的弱点。
- en: Observing a low predicting power out-of-sample of a model that exhibits a high
    level of goodness of fit in-sample is a typical definition of overfitting (Babyak,
    [2004](#CR4)).
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在样本外呈现出高拟合度模型的低预测能力是过拟合的典型定义（Babyak，[2004](#CR4)）。
- en: Intuitively, one can see that it would be easy to find patterns in the data
    that seem to correspond to a link that does not exist, especially because we adapt
    these patterns to the target variable using the estimation of the functional form
    parameters.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 直觉上，我们可以看出，在数据中很容易找到似乎对应于不存在的联系的模式，特别是因为我们通过估计函数形式参数来将这些模式适应于目标变量。
- en: 'This functional form, which characterizes the model, tends to adapt better
    to these spurious patterns when it is made more complex. This complexity depends
    on the number of parameters, and essentially comes from two sources: the complexity
    of the functional form associated to each variable, and the number of variables
    used in the model (Hawkins ([2004](#CR22)) discusses these points in depth).'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这种描述模型的函数形式，在更复杂的情况下，更容易适应这些虚假模式。这种复杂性取决于参数的数量，并且主要来自两个来源：与每个变量相关的函数形式的复杂性，以及模型中使用的变量数量（Hawkins
    ([2004](#CR22)) 对这些问题进行了深入讨论）。
- en: 'This is why increasing the number of predictors in a multivariate regression
    is well known to expose the danger of overfitting, so much so that econometricians
    on the subject like to joke by citing John von Neumann’s famous quote: “With four
    parameters I can fit an elephant and with five I can make him wiggle his trunk”.
    This is especially true when the number of observations is reduced, a situation
    which occurs frequently in real-life cases. Indeed, for a given number of observations,
    increasing the number of predictors in a multivariate model decreases the variance
    of the residuals, making the model ‘better’ in terms of goodness of fit, but only
    in appearance.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是为什么增加多变量回归中预测变量数量会暴露过拟合风险的原因，以至于像经济计量学家这样的专家会引用约翰·冯·诺伊曼的著名语录而开玩笑：“用四个参数我可以拟合一只大象，用五个我可以让它摇摆鼻子”。当观察数量减少时，这种情况经常发生。事实上，对于给定数量的观察，增加多变量模型中的预测变量数量会减少残差的方差，使模型在拟合度方面变得“更好”，但只是表面上看起来如此。
- en: The problem becomes even worse when the number of predictors increases so much
    that it becomes higher than the number of observations. In such a case, the covariance
    matrix of the predictors *X′X* is not invertible, leading to a failure of the
    usual ordinary least squares solution to the parameter’s estimation of the linear
    model, defined as:![$$ \hat{\beta}={\left[{X}^{\prime }X\right]}^{-1}{X}^{\prime
    }Y. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ9.png)(2.9)The
    matrix inversion needed to compute the OLS estimator can be seen as a system of
    equations to solve, and in our case, there is no uniqueness of the solution. The
    problem is thus said to be “ill-posed” (Hadamard, [1902](#CR21)).A very common
    approach to this problem is to regularize the regression using a penalty of the
    L²-norm of the coefficient estimates (called Ridge regression (Hoerl & Kennard,
    [1988](#CR24)) or Tikhonov regularization). Recall that in ordinary least squares,
    the sum of the squared differences between the straight line and the data is minimized.
    The estimate of the parameter β, called ![$$ \hat{\upbeta} $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_IEq1.png),
    is thus the solution of the optimization problem:![$$ \underset{\beta }{\mathit{\min}}\
    {\left\Vert Y- X\beta \right\Vert}_2^2\. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ10.png)(2.10)In
    Ridge regression, the penalty of the L²-norm is added as follows:![$$ \underset{\beta
    }{\mathit{\min}}\ {\left\Vert Y- X\beta \right\Vert}_2^2+\lambda {\left\Vert \beta
    \right\Vert}_2^2, $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ11.png)(2.11)*Here,
    “λ” is the Ridge penalty parameter*.Leading to the following shrunk estimates
    of the parameters:![$$ {\hat{\beta}}^{Ridge}={\left[{X}^{\prime }X+\lambda I\right]}^{-1}{X}^{\prime
    }Y. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ12.png)(2.12)*“I”
    is the n × n identity matrix.*
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 当预测变量的数量增加到比观察数量更高时，问题变得更加严重。在这种情况下，预测变量的协方差矩阵*X'X*不可逆，导致通常的普通最小二乘线性模型参数估计解决方案失败，定义为：![$$
    \hat{\beta}={\left[{X}^{\prime }X\right]}^{-1}{X}^{\prime }Y. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ9.png)(2.9)计算OLS估计量所需的矩阵求逆可以看作是要解决的一组方程，而在我们的情况下，解决方案不唯一。因此，这个问题被称为“病态”（Hadamard，[1902](#CR21)）。解决这个问题的一个非常常见的方法是使用L²-范数的系数估计值进行回归正则化（称为岭回归（Hoerl
    & Kennard，[1988](#CR24)）或Tikhonov正则化）。请记住，在普通最小二乘中，直线与数据之间的平方差之和被最小化。参数β的估计值，称为![$$
    \hat{\upbeta} $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_IEq1.png)，因此是优化问题的解：![$$
    \underset{\beta }{\mathit{\min}}\ {\left\Vert Y- X\beta \right\Vert}_2^2\. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ10.png)(2.10)在岭回归中，L²-范数的惩罚被添加如下：![$$
    \underset{\beta }{\mathit{\min}}\ {\left\Vert Y- X\beta \right\Vert}_2^2+\lambda
    {\left\Vert \beta \right\Vert}_2^2, $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ11.png)(2.11)*这里，“λ”是岭惩罚参数*。导致参数的以下缩小估计值：![$$
    {\hat{\beta}}^{Ridge}={\left[{X}^{\prime }X+\lambda I\right]}^{-1}{X}^{\prime
    }Y. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ12.png)(2.12)*“I”是n × n单位矩阵。*
- en: On top of allowing the matrix inversion, the penalization of the L²-norm automatically
    reduces the magnitude of the coefficients estimated by OLS, leading to better
    out-of-sample estimates (Van Dusen, [2016](#CR40)) proposes a comprehensive overview
    of this point). It is also possible to introduce in the optimization problem a
    penalty of both the L¹ and L²-norm, a technique called Elastic Net regularization
    (Tibshirani, [1996](#CR39), see also Zou and Hastie, [2005](#CR46)). While adding
    a penalization of the L¹-norm, some of the coefficients fall to zero, allowing
    for a selection of the independent variables. Ridge and Elastic Net regressions
    thus address the same problem as polymodels, which is an alternative when trying
    to prevent overfitting when modeling with a large number of variables.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在允许矩阵求逆的基础上，L²-范数的惩罚自动减小了OLS估计的系数的大小，从而导致更好的外样本估计（Van Dusen，[2016](#CR40)）提出了对这一点的全面概述）。还可以在优化问题中引入L¹和L²-范数的惩罚，这种技术称为弹性网络正则化（Tibshirani，[1996](#CR39)，另见Zou和Hastie，[2005](#CR46)）。当加入L¹-范数的惩罚时，一些系数会变为零，从而实现对自变量的选择。岭回归和弹性网络回归因此解决了与多模型相同的问题，这是在使用大量变量进行建模时防止过度拟合的替代方法。
- en: However, in most of the applications of these approaches, the number of degrees
    of freedom of the model stays very low even after variable selection, which always
    raises some reservations about the resulting fit. This is a concern that is easily
    removed by using polymodels, because the number of degrees of freedom is greatly
    increased by the use of a single variable in each elementary model. Using a polymodel
    thus offers a simpler and more effective approach to solving these ill-posed problems.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在这些方法的大多数应用中，即使在变量选择后，模型的自由度数量仍然非常低，这总是会对结果拟合引起一些疑虑。通过使用多模型，可以轻松解决这个问题，因为每个基本模型中使用单个变量大大增加了自由度的数量。因此，使用多模型提供了一种更简单、更有效的解决这些问题的方法。
- en: To better understand how the multivariate models overfit compared to polymodels,
    we propose to illustrate our reasoning with a toy example. To tackle a familiar
    problem, we model the returns of the S&P 500 as a function of a set of *n* predictors
    (as presented in Eq. ([2.7](#Equ7)), in which *Y* is the S&P returns).
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解多元模型与多模型相比过度拟合的情况，我们提出通过一个玩具例子来说明我们的推理。为了解决一个熟悉的问题，我们将S&P 500的回报建模为一组*n*个预测变量的函数（如方程
    ([2.7](#Equ7)) 中所示，其中*Y*是S&P回报）。
- en: 'To test the spuriousness of the various approaches, we build a set of predictors
    that contains values randomly drawn from a Student’s t-distribution with 4 degrees
    of freedom:^([3](#Fn3))![$$ X=0+\varepsilon $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equa.png)![$$
    \varepsilon \sim {t}_{\nu =4.} $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ13.png)(2.13)Hence,
    by construction, *there is no link between the target variable and the predictors*
    in our experiment. There is only noise to fit in the explanatory variables. To
    obtain *f ()*, we compare three different modeling techniques:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试各种方法的虚假性，我们构建了一个包含从自由度为4的学生t分布中随机抽取的值的预测器集合:^([3](#Fn3))![$$ X=0+\varepsilon
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equa.png)![$$ \varepsilon
    \sim {t}_{\nu =4.} $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ13.png)(2.13)因此，根据构造，*在我们的实验中，目标变量与预测变量之间没有任何联系*。只有噪声可以适应解释变量。为了得到*f()*，我们比较了三种不同的建模技术：
- en: The multivariate linear model described by Eq. ([2.8](#Equ8)), estimated using
    the OLS estimator described by Eq. ([2.9](#Equ9)).
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由方程 ([2.8](#Equ8)) 描述的多元线性模型，使用方程 ([2.9](#Equ9)) 描述的OLS估计器进行估计。
- en: The same multivariate model estimated using the Ridge estimator described by
    Eq. ([2.12](#Equ12)). The parameter λ, which is crucial for the estimation, is
    chosen using a 5-fold cross-validation (see Golub et al., [1979](#CR19)) on the
    use of cross-validation to choose the Ridge parameter).
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用由方程 ([2.12](#Equ12)) 描述的Ridge估计器进行估计的相同多元模型。对于估计至关重要的参数λ是通过5倍交叉验证（参见Golub等人，[1979](#CR19)）选择的（有关使用交叉验证选择Ridge参数的使用）。
- en: A polymodel, as described in Eq. ([2.5](#Equ5)), with elementary models defined
    as linear univariate models estimated with OLS.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如方程 ([2.5](#Equ5)) 中描述的多模型，其中基本模型被定义为使用OLS估计的线性单变量模型。
- en: This simple setting does not include non-linearity or variable selection, so
    that the results are only driven by the multivariate/univariate distinction. We
    estimate the parameters of each of these three models using the weekly returns
    of the S&P500 for the period from 2001-01-01 to 2003-12-31, which correspond to
    157 observations. We then generate new values for *X* and use them with the previously
    estimated parameters to model the S&P’s returns for the period from 2004-01-01
    to 2006-12-31\. Of course, we don’t expect any of these predictions to be good,
    the experiment aims to reflect the ability of the different models to be trapped
    by fitting pure noise.Thereby, we measure the overfitting by comparing the goodness
    of fit in-sample (the 2001–2003 period) to the goodness of fit out-of-sample (the
    2004–2006 period). The goodness of fit is appreciated using the R², which is one
    minus the sum of squared residuals over the total sum of squares:![$$ {R}^2=1-\frac{\sum
    \limits_{s=1}^t{\left({y}_s-{f}_t\left({x}_s\right)\right)}^2}{\sum \limits_{s=1}^t{\left({y}_s-{\overline{y}}_t\right)}^2}.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ14.png)(2.14)*Here,
    “t” is the current time index (i.e. end of 2003), “s” is the rolling time index
    in the window (i.e. it takes weekly date values between 01-2001 and 12-2003),
    “* ![$$ {\overline{y}}_t $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_IEq2.png)*”
    is the average of the target variable between s= 1 and s=t, and “ f*[*t*]*” is
    the fitted function obtained with data available at date t.*More precisely, to
    assess overfitting, we measure the “Out-of-Sample R²”, which is the same formula
    as the “In-sample R²” above, but with in-sample coefficients and out-of-sample
    data:![$$ {R^2}_{oos}=1-\frac{\sum \limits_{s=t+1}^{t+157}{\left({y}_s-{f}_t\left({x}_s\right)\right)}^2}{\sum
    \limits_{s=t+1}^{t+157}{\left({y}_s-{\overline{y}}_{t+157}\right)}^2}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ15.png)(2.15)The
    formula above reflects that new data, between *t* + 1 and *t* + 157, is used to
    recompute the *R*^(*2*), but that the fitted function, f[t](), stays unchanged.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这个简单的设置不包括非线性或变量选择，因此结果仅由多元/单一区分驱动。我们使用 2001-01-01 至 2003-12-31 期间的标普500周回报估计了这三种模型的参数，这对应于
    157 个观测值。然后，我们为 *X* 生成新值，并使用先前估计的参数将它们与模型化的标普回报模型化为 2004-01-01 至 2006-12-31 期间的情况。当然，我们不指望这些预测中有任何好的结果，实验的目的是反映不同模型被拟合纯噪音的能力。因此，我们通过比较样本内（2001年至2003年期间）的拟合度和样本外（2004年至2006年期间）的拟合度来测量过拟合。拟合度使用R²来评估，它是总平方和中残差平方和的减法值的百分比:![$$
    {R}^2=1-\frac{\sum \limits_{s=1}^t{\left({y}_s-{f}_t\left({x}_s\right)\right)}^2}{\sum
    \limits_{s=1}^t{\left({y}_s-{\overline{y}}_t\right)}^2}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ14.png)(2.14)*这里，“t”是当前时间索引（即
    2003 年底），“s”是窗口中滚动时间索引（即它在 01-2001 和 12-2003 之间采用每周日期值），“ ![$$ {\overline{y}}_t
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_IEq2.png)”是在 s=
    1 和 s=t 之间的目标变量的平均值，“ f*[*t*]*”是使用在日期 t 可用的数据估计的拟合函数。*更确切地说，为了评估过拟合，我们测量“样本外R²”，它与上面的“样本内R²”公式相同，但使用样本内系数和样本外数据:![$$
    {R^2}_{oos}=1-\frac{\sum \limits_{s=t+1}^{t+157}{\left({y}_s-{f}_t\left({x}_s\right)\right)}^2}{\sum
    \limits_{s=t+1}^{t+157}{\left({y}_s-{\overline{y}}_{t+157}\right)}^2}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ15.png)(2.15)上述公式反映了使用新数据（在
    *t* + 1 到 *t* + 157 之间）重新计算 *R*^(*2*)，但拟合函数 *f[t]*() 保持不变。
- en: 'We then measure the *Spread* between the “In-Sample R²” and the “Out-of-Sample
    R²”:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接着测量“样本内R²”和“样本外R²”之间的*差异*：
- en: '![$$ Spread={R^2}_{IS}-{R^2}_{OOS}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ16.png)(2.16)For
    the polymodel, we do not represent the spread of each elementary model but choose
    to present the average^([4](#Fn4)) spread among elementary models, for the sake
    of brevity.Next we observe how the spread behaves as a function of the number
    of predictors *n*. We make this number vary between 1 and 156 (recall that there
    are 157 observations). This overfitting measure as a function of the number of
    predictors is compared for the three modeling techniques in Fig. [2.1](#Fig1):![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig1_HTML.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![$$ 差异={R^2}_{IS}-{R^2}_{OOS}. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ16.png)(2.16)对于多元模型，我们不表示每个基本模型的差异，而是选择呈现基本模型之间的平均^([4](#Fn4))
    差异，为了简洁起见。接下来我们观察差异如何随预测变量数量 *n* 的变化而变化。我们将这个数字变化在 1 和 156 之间（回顾一下共有 157 个观测值）。在图
    [2.1](#Fig1) 中，将这个作为过拟合度量的预测变量数量的函数进行了比较：![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig1_HTML.png)'
- en: Fig. 2.1
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1
- en: Spreads between In-Sample vs Out-of-Sample R² as a function of the number of
    explanatory variables included in the regression
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 根据回归中包含的解释变量的数量，内样本和外样本R²之间的差距（缩放）
- en: The graph above represents the spread between the in-sample and out-of-sample
    goodness of fit, as a function of the number of regressors (for the polymodels
    the value displayed is the (unweighted, un-selected) average of the spreads among
    the different elementary models). For the multivariate models, the larger the
    number of independent variables, the larger the spread, thus the stronger the
    overfitting.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 上图表示内样本和外样本拟合优度之间的差距，作为回归系数数量的函数（对于多项模型，显示的值是在不同基本模型之间的差距的（非加权，未选择）平均值）。对于多元模型，独立变量的数量越多，差距越大，因此过拟合越强。
- en: The spread of the multivariate OLS is so explosive when the number of regressors
    reaches the number of data points that it breaks the scale of the graph. Zooming
    makes it understandable (see Fig. [2.2](#Fig2)):![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig2_HTML.png)
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 当回归器的数量达到数据点的数量时，多元OLS的差距会变得非常爆炸性，以至于它打破了图的比例。通过缩放可以理解（见图[2.2](#Fig2)）：![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig2_HTML.png)
- en: Fig. 2.2
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.2
- en: Spreads between In-Sample vs Out-of-Sample R² as a function of the number of
    explanatory variables included in the regression (zoom)
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 根据回归中包含的解释变量的数量，内样本和外样本的R²之间的差距（缩放）
- en: The Ridge estimator behaves as expected in this toy example, notably reducing
    the overfitting compared to OLS in the multivariate case. Indeed, for the extreme
    case where *n* = 156, the spread of the Ridge estimator is roughly 3,000 times
    lower than that of the classical OLS estimator. However, even with regularization,
    it is clear that the overfitting grows as a function of the number of variables
    included in the multivariate models.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个玩具例子中，Ridge估计器表现如预期，明显减少了与多元OLS相比的过拟合。实际上，对于极端情况，即*n*=156时，Ridge估计器的差距大约比经典OLS估计器低3000倍。然而，即使有正则化，显然过拟合也随着多元模型中包含的变量数量的增加而增加。
- en: This is not true in the case of the average spread in the polymodel, which is
    (of course) asymptotically constant when the number of regressors *n* increases.
    For *n* = 156, the spread of the polymodel is 10⁵ times lower than OLS and 34
    times lower than Ridge in this particular case (Fig. [2.3](#Fig3)).![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig3_HTML.png)
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在多项式模型的平均差距的情况下，当回归数*n*增加时，差距（当然）在渐近时是恒定的。对于*n*=156的情况，多项式模型的差距比OLS低了10⁵倍，在这种特殊情况下比Ridge低了34倍（图[2.3](#Fig3)）。![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig3_HTML.png)
- en: Fig. 2.3
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.3
- en: Average spread between In-Sample vs Out-of-Sample R² as a function of the number
    of explanatory variables included in the regression (polymodels only)
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 解释变量数量的函数（仅限多项式模型）中内样本和外样本R²之间的平均差距
- en: 'This straightforward experiment also helps us to understand the nature of overfitting
    by comparing the *In-Sample R*^(*2*) and *Out-of-Sample R*^(*2*) of the three
    models:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 这个简单的实验还帮助我们通过比较三个模型的内样本R²和外样本R²来理解过拟合的本质：
- en: In these three graphs, we have shown the *In-Sample R*^(*2*) and the *Out-of-Sample
    R*^(*2*) as a function of the number of independent variables, for the three fitting
    methods. In both of the multivariate models, we see that the *Spread* is not growing
    just because of the increase of the *In-Sample R*^(*2*). The *Out-of-Sample R*^(*2*)
    worsens sharply, so dramatically that it quickly becomes the most important figure
    in the Spread computation. This illustrates the fact that overfitting not only
    results in too high expectations about the out-of-sample performance, but to a
    significant extent it actually also contributes to its deterioration, as we act
    only to follow past noise in that case. Note that the scale of the *R*² is quite
    different among the figures (Figs. [2.4](#Fig4), [2.5](#Fig5) and [2.6](#Fig6)).![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig4_HTML.png)
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在这三个图中，我们展示了内样本R²和外样本R²作为独立变量数量的函数，对于三种拟合方法。在这两种多元模型中，我们发现*差距*增长不仅仅是因为*内样本R²*的增加。外样本R²急剧恶化，以至于它迅速成为差距计算中最重要的数字。这说明过拟合不仅导致对外样本性能有太高的期望，而且在很大程度上实际上也导致其恶化，因为在这种情况下我们只是在跟随过去的噪声。注意R²的比例在图中是完全不同的（图[2.4](#Fig4)、[2.5](#Fig5)和[2.6](#Fig6)）。![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig4_HTML.png)
- en: Fig. 2.4
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.4
- en: 'Multivariate OLS: In-Sample vs Out-of-Sample R² as a function of the number
    of explanatory variables included in the regression'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 多元OLS回归：样本内与样本外的R²随包含在回归中的解释变量数量的变化而变化
- en: '![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig5_HTML.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig5_HTML.png)'
- en: Fig. 2.5
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.5
- en: 'Multivariate Ridge: In-Sample vs Out-of-Sample R² as a function of the number
    of explanatory variables included in the regression'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 多元岭回归：样本内与样本外的R²随包含在回归中的解释变量数量的变化而变化
- en: '![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig6_HTML.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/519851_1_En_2_Chapter/519851_1_En_2_Fig6_HTML.png)'
- en: Fig. 2.6
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.6
- en: 'Polymodels (Univariate OLS): In-Sample vs Out-of-Sample R² as a function of
    the number of explanatory variables included in the regression'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 多模型（单变量OLS）：样本内与样本外的R²随包含在回归中的解释变量数量的变化而变化
- en: Of course, this toy example is a bit simplistic, far from the techniques we
    actually use,^([5](#Fn5)) but it allows us to explain the phenomenon of overfitting
    while giving a taste of the magnitude of its effects. Apart from the achieved
    levels of overfitting reduction, which are clearly dominated by polymodels, we
    may also question the use of a cross-validated regularized estimator when it seems
    that a repetition of simple OLS estimates performs better. We let the supporters
    of Occam’s razor make their choice.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，这个玩具示例有点简化，远离我们实际使用的技术，^([5](#Fn5))但它使我们能够解释过度拟合现象，并使我们对其效果的大小有所了解。除了明显由多模型主导的过度拟合降低水平外，当似乎简单OLS估计的重复表现更好时，我们还可以质疑交叉验证的正则化估计器的使用。我们让奥卡姆剃刀的支持者做出选择。
- en: Another technique commonly used to handle a large number of potential candidate
    variables is stepwise regression. Stepwise regression builds the final model by
    starting with all variables in the model, and then eliminates some of them (‘backward
    elimination’), or it starts with no variable, and then progressively introduces
    them into the model (‘forward selection’) (Hocking, [1976](#CR23)). The selection
    of the variables is based on a particular goodness of fit criterion, which often
    encourages a reduced number of variables in the model, such as adjusted R², the
    Akaike Information Criterion or Bayesian Information Criterion. A step-by-step
    procedure is then followed, in which the interest of adding/removing a variable
    of the model is evaluated using the goodness of fit measure at each step. Such
    a method may preserve a reasonable number of degrees of freedom (especially in
    the forward selection procedure), and also allows one to integrate non-linear
    variations of the independent variables more easily than Ridge regressions. However,
    such a repeated procedure creates a bias in the statistics used to assess its
    goodness of fit (Wilkinson & Dallal, [1981](#CR42)), and generally, the step-by-step
    procedure leads to overfitting (Flom & Cassell, [2007](#CR17)). Polymodels may
    be estimated in very different manners, hence one can easily avoid the trap of
    the step-by-step procedure.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种常用于处理大量潜在候选变量的技术是逐步回归。逐步回归通过将所有变量置于模型中开始构建最终模型，然后消除其中一些变量（'向后消除'），或者从不包含变量开始，然后逐步将它们引入模型中（'向前选择'）（霍金，[1976](#CR23)）。变量的选择基于特定的拟合优度准则，这些准则通常鼓励在模型中减少变量的数量，例如调整后的R²、阿卡信息准则或贝叶斯信息准则。然后，按照一步一步的程序进行，评估每一步模型的添加/删除变量的兴趣，使用每一步的拟合优度量度。这样的方法可以保留合理数量的自由度（特别是在向前选择过程中），并且也比岭回归更容易地将自变量的非线性变化整合进来。然而，这样的重复程序会导致用于评估其拟合优度的统计量存在偏差（威尔金森和达拉尔，[1981](#CR42)），通常，一步一步的过程会导致过度拟合（弗洛姆和卡塞尔，[2007](#CR17)）。当潜在的独立变量数量很高时，多模型可能以非常不同的方式进行估计，因此在一步一步的过程中可以轻松避免陷阱。
- en: Considering the usual alternatives to stepwise selection or regularization,
    the polymodel approach presents an effective way to reduce overfitting, since
    it cannot really be avoided in multivariate models when the number of potential
    independent variables is high.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到逐步选择或正则化的常见替代方案，多模型方法提供了一种有效的减少过度拟合的方法，因为当潜在独立变量的数量很高时，在多元模型中实际上无法避免过度拟合。
- en: 2.4.2 Increasing Precision
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.2 增加精度
- en: Another concern of econometrics, though less often emphasized, is underfitting.
    The simplest way to model a relation between two variables is a linear model,
    however, there is no particular reason for the true reaction function to be a
    straight line. Even if the linear model delivers acceptable results for most of
    the cases, these results can be improved by introducing a smooth curve in place
    of the usual straight line. Indeed, if the true underlying model is non-linear,
    then a non-linear model should perform better than a linear one, thanks to its
    flexibility. However, the reverse is not true, if the underlying model is linear,
    then both linear and non-linear models have the ability to fit the straight line.^([6](#Fn6))
    Moreover, non-linearity as a broad phenomenon has been found to be present in
    various financial situations, such as multi-factor modeling of equity markets
    (Caginalp & DeSantis, [2011](#CR9), [2019](#CR10)), multi-factor modeling of interest
    rate volatility (Boudoukh et al., [1999](#CR8)), or lead-lag modeling of foreign
    exchange rates (Serletis et al., [2012](#CR35)).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 经济计量学的另一个关注点，尽管不经常被强调，是欠拟合。模拟两个变量之间关系的最简单方法是线性模型，然而，真实反应函数为直线并没有特定的原因。即使线性模型对大多数情况下都能产生可接受的结果，但是通过引入平滑曲线来取代通常的直线，这些结果可以得到改进。事实上，如果真实的基础模型是非线性的，那么非线性模型应该比线性模型表现更好，这要归功于其灵活性。然而，反之并不成立，如果基础模型是线性的，那么线性和非线性模型都有能力拟合直线。[^6]
- en: In many domains, such as finance, a relevant increase in prediction accuracy
    can be decisive in terms of economic consequences, but the benefits that one can
    obtain from using non-linear modeling as a standard do not necessarily restrict
    to an increase in precision with respect to the linear model. In numerous situations,
    linear modeling leads to wrong modeling. Even in the cases where a linear model
    delivers good results *on average*, the events that occur in the tails of the
    distribution of the independent variables may demonstrate a very different response
    function with the target variable. This could have the worst consequences for
    the practitioner, since a model that is assumed to be good, and that seems to
    deliver consistently good results, may suddenly fail to make any accurate predictions.
    From this point of view, non-linear modeling is not just a viable method if one
    wants to slightly increase the accuracy of predictions, but it is a requirement
    to avoid surprises in extreme times.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多领域，如金融领域，预测准确性的显著提高可能在经济后果方面具有决定性意义，但是使用非线性建模作为标准可以获得的好处不一定仅限于相对于线性模型的精度增加。在许多情况下，线性建模会导致错误的建模。即使在线性模型平均下能够产生良好的结果的情况下，独立变量分布尾部发生的事件可能表现出与目标变量非常不同的响应函数。这对从业者可能会造成最糟糕的后果，因为一个被认为是良好的模型，似乎始终能够产生一致良好的结果，突然间可能无法进行任何准确的预测。从这个角度来看，非线性建模不仅是一种如果想要略微提高预测准确性的可行方法，而且是一种在极端情况下避免出现意外的要求。
- en: A good example to illustrate this point is the perspective of fund of funds
    managers, who can be concerned with the multi-factor modeling of hedge fund returns.
    Hedge funds bear a significant tail risk, so their concave payoffs cannot be properly
    described with a linear factor model (Agarwal & Naik, [2004](#CR1)). A linear
    multi-factor model may be able to explain “normal times”, non-extreme returns
    of hedge funds, but since the relation with their factor exposures is non-linear,
    it would be incapable of modeling their extreme returns, justifying the development
    of non-linear methods for this purpose (e.g. Cherny et al., [2010](#CR11)).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个很好的例子来说明这一点是基金经理的观点，他们可能关注对冲基金收益的多因子建模。对冲基金承担着显著的尾部风险，因此它们的凹形收益不能用线性因子模型来恰当描述。线性多因子模型可能能够解释对冲基金的“正常时期”，即非极端收益，但是由于与其因子暴露之间的关系是非线性的，它将无法对其极端收益进行建模，从而证明了为此目的开发非线性方法的必要性（例如，Cherny等人，[2010](#CR11)）。
- en: The use of non-linear functions in elementary models, for example polynomials,
    if fitted properly, allows one to increase the precision of the predictions, and
    to model extreme event^([7](#Fn7)) For example, we may define the function *φ*[*i*](*X*[*i*])
    of Eq. ([2.6](#Equ6)) as:![$$ {\varphi}_i\left({X}_i\right)=\sum \limits_{h=0}^u{\beta}_{i,h}{X}_i^h.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ17.png)(2.17)The
    function used above for the elementary model is a weighted sum of polynomials.
    The weights of such a model may be estimated with OLS. However, simple polynomials
    are highly correlated, and one of the assumptions of the OLS estimator is the
    linear independence of the regressors. Still, this assumption can be satisfied
    by orthogonalizing the polynomials. Assuming that the joint distribution of the
    factors is a Gaussian copula, we are led to use Hermite polynomials (Cherny et
    al., [2010](#CR11)). Chebyshev polynomials are known to be suitable for OLS estimations
    in the interval [−1, 1] (Mason & Handscomb, [2002](#CR29)), an interval in which
    most of the financial returns are included. Finally, Guan ([2019](#CR20)) proposed
    to numerically self-orthogonalize the polynomials. All these alternative choices
    have pros and cons, depending on the application. Note that plenty of possibilities
    exist for non-linearly approximating the functions *φ*[*i*](*X*[*i*]). For example,
    within the non-parametric world, the Nadaraya–Watson estimator (Nadaraya, [1964](#CR30);
    Watson, [1964](#CR41)), also known as kernel regression, may deliver suitable
    results. Still, polynomial regression has the advantage of being extremely easy
    to implement, and thus may be quickly computed in real world situations.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在基础模型中使用非线性函数，例如多项式，如果适当拟合，可以增加预测的精度，并模拟极端事件^([7](#Fn7))。例如，我们可以将方程（[2.6](#Equ6)）中的函数*φ*[*i*](*X*[*i*])定义为：![$$
    {\varphi}_i\left({X}_i\right)=\sum \limits_{h=0}^u{\beta}_{i,h}{X}_i^h. $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ17.png)（2.17）上述基础模型中使用的函数是多项式的加权和。这样的模型的权重可以通过OLS估计。然而，简单的多项式之间高度相关，并且OLS估计量的假设之一是回归变量的线性独立性。尽管如此，通过正交化多项式可以满足这一假设。假设因素的联合分布是高斯Copula，我们被引导使用Hermite多项式（Cherny等，[2010](#CR11)）。Chebyshev多项式已知适用于区间[−1,
    1]的OLS估计（Mason＆Handscomb，[2002](#CR29)），这个区间包含大部分金融收益。最后，Guan（[2019](#CR20)）提议对多项式进行数值自正交化。所有这些替代选择都有利有弊，取决于应用。请注意，存在许多非线性逼近函数*φ*[*i*](*X*[*i*])的可能性。例如，在非参数世界中，Nadaraya–Watson估计器（Nadaraya，[1964](#CR30)；Watson，[1964](#CR41)），也称为核回归，可能会产生合适的结果。尽管如此，多项式回归具有极易实现的优点，因此可以在现实世界中快速计算。
- en: Of course, our reasoning about the superiority of non-linear over linear techniques
    is conditioned by the fact that the polynomial model, if used, is not blindly
    fitted. Indeed, because the polynomial model is more complex, it is more likely
    to result in overfitting. To tackle this question, Zhang ([2019](#CR45)) proposed
    to use regularization to shrink the parameters of polynomial elementary models.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们对非线性技术优于线性技术的推理是有条件的，即多项式模型如果使用，则不是盲目拟合的。事实上，由于多项式模型更复杂，更容易导致过拟合。为了解决这个问题，Zhang（[2019](#CR45)）提议使用正则化来收缩多项式基础模型的参数。
- en: The use of non-linear modeling allows for a very flexible functional form that,
    if used properly, is more data-driven than model-driven. This spirit of being
    reasonably adaptive to the data is also reflected in the variable assumptions
    made in the polymodels. Indeed, as we would not wish to miss a relevant perspective
    on reality to understand it, Polymodel Theory is an invitation to include any
    potentially important variable in the polymodel. There is virtually no limit to
    the number of variables that can (and should) be included in a polymodel *before
    the estimation procedure*. This exciting feature comes with the duty of systematically
    including a *selection method* in the estimation procedure of the polymodel, so
    that only the truly relevant variables are kept in the final estimated polymodel.
    At this stage, there is no standard for the selection method, which is therefore
    adapted to the various empirical examples (Chaps [4](519851_1_En_4_Chapter.xhtml)
    and [6](519851_1_En_6_Chapter.xhtml) propose some solutions on this point). Thus,
    on top of using weak functional assumptions, Polymodel Theory also uses weak variable
    assumptions, which constitutes a good way to avoid model rigidity, driven by assumptions
    that may turn out to be false (from a general point of view, assuming a linear
    model can be seen as a strong assumption on the functional form of the model).
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 使用非线性建模可以实现非常灵活的函数形式，如果使用得当，比起模型驱动更加数据驱动。这种合理适应数据的精神也体现在多模型中对变量假设的制定上。实际上，由于我们不希望忽视对现实的任何相关视角以理解它，多模型理论是一种邀请，可以在多模型中包含任何潜在重要的变量。在估算程序之前，几乎可以（并应该）在多模型中包含任意数量的变量。这一令人振奋的特性需要在多模型的估算过程中系统地包含一个*选择方法*，以便仅保留在最终估算的多模型中真正相关的变量。在这个阶段，没有关于选择方法的标准，因此它被适应于各种经验案例（第
    [4](519851_1_En_4_Chapter.xhtml) 和 [6](519851_1_En_6_Chapter.xhtml) 章就此提出了一些解决方案）。因此，在使用弱功能假设之上，多模型理论还使用弱变量假设，这构成了一种避免模型僵化的良好方式，该模型受到可能是错误的假设（从一般观点来看，假设线性模型可以被视为对模型的函数形式做出的强假设）的驱使。
- en: This extremely high level of flexibility of polymodels requires a careful estimation
    method. As stated, this estimation method should include a way to balance and/or
    select the different elementary models, but more importantly, the fit should not
    be too adaptive, otherwise overfitting can emerge again. Satisfying this need
    for a reasonable algorithm to fit the elementary models is the subject of Chap.
    [3](519851_1_En_3_Chapter.xhtml).
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这种极高的多模型灵活性需要一种谨慎的估算方法。正如所述，这种估算方法应包括一种平衡和/或选择不同基本模型的方法，但更重要的是，拟合过程不应过于自适应，否则可能再次出现过度拟合。满足这种对合理算法以拟合基本模型的需求是第
    [3](519851_1_En_3_Chapter.xhtml) 章的主题。
- en: The overall increase in precision which is introduced by non-linear modeling
    could be achieved using a stepwise regression. Such a method would also allow
    for automatic variable selection, however we already saw that the step-by-step
    procedure would lead to overfitting. In the case of Ridge and Elastic Net regularizations,
    introducing non-linear versions of predictors may overcome the lack of accuracy
    of a linear modeling, but it would clearly be at the cost of a greater risk of
    overfitting, since the number of coefficients in the model would necessarily increase.
    Hence, on the particular question of accurately fitting the patterns that are
    really present in large amounts of data, Polymodel Theory shows enviable characteristics
    compared to the standard alternatives.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 非线性建模引入的整体精度增加可以通过逐步回归实现。这样的方法还允许自动变量选择，然而我们已经看到逐步过程会导致过度拟合。在岭回归和弹性网正则化的情况下，引入预测变量的非线性版本可能克服线性建模的精度不足，但显然会以增加模型系数的数量为代价，这必然会增加过拟合的风险。因此，就准确拟合真正存在于大量数据中的模式这个特定问题而言，多模型理论与标准替代方案相比表现出令人羡慕的特性。
- en: 2.4.3 Increasing Robustness
  id: totrans-115
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.3 提高鲁棒性
- en: One of the most obvious benefits of using a polymodel, compared to a multivariate
    model, is the disappearance of multicollinearity. Multicollinearity, which we
    can expect to often appear often in large data samples, provides a non-robust
    estimate of the parameters, in the sense that the regression coefficients are
    highly sensitive to a small change in the data used for the estimation (see e.g.
    Belsley, [2014](#CR5)). This may be particularly problematic in the case of repeated
    fitting using a temporal rolling window, a technique often used in finance. Also,
    multicollinearity can make it difficult to reliably identify the independent variables
    that are effectively linked with the target variable that we are trying to explain.
    As it increases the standard errors of the affected coefficients, it spuriously
    reduces the *p*-value of the parameter if computed via the usual t-statistic.
    While the problem of multicollinearity among predictors can be undertaken using
    Ridge regression at the cost of accuracy (Hoerl & Kennard, [1970](#CR25)), in
    the framework of Polymodel Theory multicollinearity just doesn’t appear, which
    makes it more suitable for obtaining a robust estimation of the reaction function
    of each predictor.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 与多元模型相比，使用 polymodel 最明显的好处之一是消除了多重共线性。在大数据样本中，我们经常会遇到多重共线性，它提供了对参数的非稳健估计，即回归系数对估计数据的微小变化非常敏感（参见例如
    Belsley，[2014](#CR5)）。这在使用时间滚动窗口进行重复拟合时尤其成问题，这是金融领域经常使用的一种技术。此外，多重共线性可能会使我们难以可靠地识别与我们试图解释的目标变量有效相关的自变量。由于它增加了受影响系数的标准误差，如果通过常规
    t 统计量计算，则虚高了参数的 *p*-值。虽然可以使用 Ridge 回归来解决预测变量之间的多重共线性问题，但会以准确性为代价（Hoerl＆Kennard，[1970](#CR25)），但在
    Polymodel 理论框架下，多重共线性根本不会出现，这使其更适用于获得对每个预测变量的反应函数的稳健估计。
- en: We propose to draw from the real world another toy example to illustrate this
    particular point. Again, we consider the problem of fitting a multi-factor model
    with a multivariate OLS, a multivariate Ridge and a simple linear polymodel. The
    target variable is still the weekly returns of the S&P 500, and we continue to
    study it over the period from 2001-01-01 to 2003-12-31 (157 observations). However,
    the set of predictors we use to predict it is no longer composed of random draws.
    Instead, we use 43 US equity indices, most of which are sectorial indices.^([8](#Fn8))
    We first estimate the three different models using the 43 explanatory variables
    and collect their associated parameters. Next, we re-estimate the three models
    while removing one of the predictors, thus keeping 42 of them. If the initial
    estimates were robust, they should be stable, and thus be exactly the same as
    the coefficients estimated with 43 variables in the multi-factor model. For each
    model, we measure the absolute change in coefficients, expected to be equal to
    0, with the following basic metric:![$$ {\Delta}_{coeff}=\left|\frac{{\hat{\beta}}_{42}-{\hat{\beta}}_{43}}{{\hat{\beta}}_{43}}\right|.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ18.png)(2.18)This
    procedure is then repeated 43 times, each time changing the variable that is removed
    from the predictor set, so that we can collect 42 × 43 = 1,806 values for Δ[coeff]
    for the three models. Here are the descriptive statistics of these values (Table
    [2.1](#Tab1)):Table 2.1
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们建议从现实世界中提取另一个玩具示例来说明这一特定点。同样，我们考虑用多元OLS、多元Ridge和简单线性polymodel拟合多因子模型的问题。目标变量仍然是标准普尔500指数的周回报，我们继续研究2001-01-01至2003-12-31（157次观测）的情况。然而，我们用于预测它的预测变量集合不再由随机选择组成。相反，我们使用了43个美国股票指数，其中大多数是行业指数。^([8](#Fn8))我们首先使用这43个解释变量估计三种不同的模型，并收集它们的相关参数。接下来，我们重新估计三个模型，同时删除其中一个预测变量，因此保留42个。如果初始估计是稳健的，它们应该是稳定的，因此与多因子模型中使用43个变量估计的系数完全相同。对于每个模型，我们测量系数的绝对变化，预计等于0，使用以下基本度量标准：![$$
    {\Delta}_{coeff}=\left|\frac{{\hat{\beta}}_{42}-{\hat{\beta}}_{43}}{{\hat{\beta}}_{43}}\right|.
    $$](../images/519851_1_En_2_Chapter/519851_1_En_2_Chapter_TeX_Equ18.png)(2.18)然后，此过程重复43次，每次更改从预测器集中删除的变量，以便我们可以收集三种模型的Δ[coeff]的42 × 43 = 1,806个值。这些值的描述性统计如下（表[2.1](#Tab1)）：表2.1
- en: Sensitivity of estimates to changes in the set of explanatory variables
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 对解释变量集合变化的估计的敏感性
- en: '|   | Multivariate (OLS) | Multivariate (Ridge) | Polymodels (Univariate OLS)
    |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '|   | 多元（OLS） | 多元（Ridge） | polymodel（单变量OLS） |'
- en: '| --- | --- | --- | --- |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Count | 1,806 | 1,806 | 1,806 |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| 计数 | 1,806 | 1,806 | 1,806 |'
- en: '| Mean | 76% | 28% | 0% |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 均值 | 76% | 28% | 0% |'
- en: '| Min | 0% | 0% | 0% |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 最小值 | 0% | 0% | 0% |'
- en: '| Quantile 25% | 2% | 1% | 0% |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 四分位数 25% | 2% | 1% | 0% |'
- en: '| Quantile 50% | 10% | 5% | 0% |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 四分位数 50% | 10% | 5% | 0% |'
- en: '| Quantile 75% | 39% | 18% | 0% |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 四分位数 75% | 39% | 18% | 0% |'
- en: '| Max | 9.110% | 1.556% | 0% |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 最大值 | 9.110% | 1.556% | 0% |'
- en: '| Std | 4.12 | 0.93 | 0.00 |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 标准差 | 4.12 | 0.93 | 0.00 |'
- en: '| Kurtosis | 233.30 | 88.70 | 0.00 |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| 峰度 | 233.30 | 88.70 | 0.00 |'
- en: '| Skewness | 13.83 | 8.19 | 0.00 |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| 偏度 | 13.83 | 8.19 | 0.00 |'
- en: The average absolute change in the coefficient is 76% for the multivariate OLS,
    28% for the multivariate Ridge, and obviously 0% for the polymodel. These extremely
    large changes in the multivariate case result from a high level of multicollinearity
    in the predictors. Indeed, their average correlation is 56%.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 多变量OLS的系数平均绝对变化为76%，多变量Ridge为28%，而多项模型显然为0%。多变量情况下这些极大的变化是由于预测变量中存在高水平的多重共线性。事实上，它们的平均相关性为56%。
- en: Of course, there are plenty of cases where the predictors used are only lowly
    correlated, or not correlated at all. Still, the higher the number of predictors
    used in the model, the more likely the appearance of multicollinearity for some
    of the explanatory variables. The simple example we presented shows that even
    if the Ridge estimator is indeed effective at reducing parameter instability,
    its results remain imperfect, while any multicollinearity totally disappears with
    polymodels, which thus provide a radical tool to solve this problem.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '当然，有很多情况下使用的预测变量只有低相关性，或者根本没有相关性。但是，使用的解释变量越多，某些解释变量出现多重共线性的可能性就越大。我们提出的简单例子表明，即使
    Ridge 估计器确实能够降低参数不稳定性，其结果仍然不完美，而多项模型则完全消除了任何多重共线性问题，因此提供了一个彻底解决这个问题的工具。  '
- en: In order to guarantee that the estimated model is reliable, one of the standard
    hypotheses in modeling is that the variance of the residuals is constant for all
    observations of the sample used for the fit. Homoskedasticity may be difficult
    to ensure while working with time series, which can show clusters of volatility
    (in finance, this phenomenon has been notably observed by Mandelbrot, [1997](#CR28);
    Engle, [1982](#CR16)). Hence, the longer the window used for the estimation, the
    less likely the homoskedasticity assumption is fulfilled. When this condition
    is not fulfilled, the standard errors of the coefficients estimated by OLS are
    biased, leading again to spurious levels of *p*-values based on t-statistics,
    and thus potentially to a wrong identification of the most relevant variables
    to consider in the analysis. Note that when trying to avoid overfitting, multivariate
    models must rely on the largest temporal depth available. In contrast, polymodels
    allow one to reduce the temporal depth of the estimations while keeping a satisfying
    number of degrees of freedom, which is less prone to overfitting. Polymodels are
    thus more likely to satisfy the hypothesis of constant variance in the sample
    while trying to simultaneously prevent overfitting. Hence, in addition to avoiding
    multicollinearity, the robustness of the modeling is also better using polymodels
    instead of multivariate models from the particular perspective of respecting the
    homoskedasticity assumption.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保估计的模型是可靠的，在建模中的一个标准假设是，用于拟合的样本的所有观测的残差方差都是恒定的。在处理时间序列时，可能很难确保同方差性，因为时间序列可能显示出波动的集群（在金融领域，曼德布罗特
    [1997](#CR28) 和恩格尔 [1982](#CR16) 已经引起了人们的注意）。因此，使用于估计的窗口越长，同方差性假设不被满足的可能性就越小。当这个条件不被满足时，OLS
    估计的系数的标准误差就会有偏差，再次导致基于 t 统计量的虚假 *p* 值水平，从而可能错误地确定在分析中要考虑的最相关的变量。请注意，在尝试避免过度拟合时，多变量模型必须依赖于可用的最大时间深度。相比之下，多项模型允许减少估计的时间深度，同时保持令人满意的自由度，这样就不太容易过度拟合。因此，除了避免多重共线性之外，从尊重同方差性假设的特定角度来看，使用多项模型而不是多变量模型也更有利于建模的稳健性。
- en: When modeling with several variables, the practitioner frequently encounters
    the problem of missing data. Missing observations in the matrix of the predictors
    prevents estimation, thus it leads either to drop all the observations of the
    other variables that have the same index (e.g. simply removing a date), or to
    fully drop the entire variable itself. When using a large number of variables,
    this question becomes more and more problematic, since a wide range of observations
    often miss, and these observations may not miss simultaneously. Whatever the choice
    taken, the use of any multivariate regression technique leads to the removal of
    an important part of the available data. The robustness of the model is also linked
    to the number of observations used to estimate its parameters. Again, polymodels
    allow to overcome this concern. Since each variable is fitted independently using
    its own elementary model, there is no need to remove any observations, the number
    of observations used in each elementary model can be different. Naturally, this
    difference should then be taken into account in the tests used to assess the statistical
    significance of each variable. By keeping all the observations, polymodels thus
    increase the robustness of the estimations compared to multivariate models.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在对多个变量建模时，从业者经常会遇到缺失数据的问题。在预测变量的矩阵中缺少观测会导致估计不准确，因此要么删除所有具有相同索引的其他变量的观测（例如简单地删除日期），要么完全删除整个变量本身。当使用大量变量时，这个问题变得越来越棘手，因为通常会缺少广泛的观测，并且这些观测可能不会同时缺失。无论采取何种选择，使用任何多元回归技术都会导致移除一部分可用数据。模型的稳健性也与用于估计其参数的观测数量相关联。再次，多模型允许克服这一问题。由于每个变量都是使用其自己的基本模型独立拟合的，因此无需删除任何观测，每个基本模型中使用的观测数量可以不同。自然地，这种差异应该在用于评估每个变量的统计显着性的测试中考虑进去。通过保留所有观测，多模型因此增加了估计的稳健性，与多元模型相比。
- en: Multivariate modeling techniques can only address these concerns about the robustness
    of the estimations with difficulty. Although Ridge regressions may partly solve
    the problem of multicollinearity, none of the multivariate techniques are able
    to respect the raw structure of the data (dynamics of variance, missing observations)
    as well as polymodels do. These findings position the polymodel technique as a
    suitable one to work with large amounts of data.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 多变量建模技术只能难以解决对估计的稳健性的担忧。尽管岭回归可能在一定程度上解决了多重共线性的问题，但没有一种多元技术能像多模型那样尊重数据的原始结构（方差的动态性，缺失观测）。这些发现将多模型技术定位为适合处理大量数据的技术。
- en: 2.5 Considerations Raised by Polymodels
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.5 多模型引发的考虑
- en: 2.5.1 Aggregation of Predictions
  id: totrans-137
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.5.1 预测的聚合
- en: One of the usual questions raised when Polymodel Theory is presented is which
    method to use to aggregate the predictions.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 当介绍多模型理论时，常常引起的一个常见问题是使用什么方法来聚合预测。
- en: First, it is important to note that Polymodel Theory offers more than an aggregated
    prediction. Since its purpose is to provide a quasi-exhaustive representation
    of the links that a variable maintains with its whole environment, there is a
    lot to learn from this representation itself. The researcher can focus on the
    dynamics of the strength of these links, their amount of non-linearity, etc. Also,
    the elementary models may be used to produce measures other than a prediction
    of the target variable, such as the Value at Risk. Thus, very different measures
    representing different aspects of the system may be produced.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，重要的是要注意，多模型理论提供的不仅仅是聚合预测。由于其目的是提供一个准确的表示一个变量与其整个环境之间关系的近似全面的表示，因此从这种表示本身就可以学到很多东西。研究人员可以关注这些联系强度的动态性，它们的非线性程度等等。此外，可以使用基本模型生成除目标变量预测之外的其他度量，例如风险价值。因此，可以生成代表系统不同方面的非常不同的度量。
- en: The aggregation of the measures that investigate the different dimensions of
    the polymodel can be done in very different ways. We may consider the entire distribution
    of these measures, as well as maxima, minima or extreme quantiles that depict
    the reactions of the system in stressed conditions. The volatility over time of
    the measures brings information about their instability. It is also possible to
    consider the ratio of the measure to its historical mean, in order to get a meaningful
    value of its relative present level.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 调查多模型不同维度的度量的聚合可以通过非常不同的方式进行。我们可以考虑这些度量的整个分布，以及在压力条件下描述系统反应的最大值、最小值或极端分位数。度量的随时间变化的波动提供了关于其不稳定性的信息。还可以考虑度量与其历史平均值的比率，以获得其相对当前水平的有意义值。
- en: Finally, aggregating the predictions of the different elementary models together
    raises the question of the correlations of different predictors.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，将不同基本模型的预测聚合在一起引发了不同预测器的相关性的问题。
- en: In order to effectively understand the stakes of this question, we approach
    it through the metaphor of an amphitheater.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 为了有效地理解这个问题的重要性，我们通过一个大礼堂的隐喻来解决它。
- en: Let us consider an amphitheater filled by students from the department of finance
    of a university. We would like to use their knowledge to predict the future returns
    of a financial asset. Before joining the amphitheater, the students have been
    selected to be the most skilled in the university for this particular task. The
    selection has been conducted using a multiple-choice questionnaire. Thus, a small
    proportion of the bad students, who have answered the questionnaire following
    a random guessing procedure, may have been selected by chance. The test used to
    determine the best students is fallible, as all tests are.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一下，一个由某大学财务系的学生填满的大礼堂。我们希望利用他们的知识来预测金融资产的未来收益。在加入大礼堂之前，学生们已经被选为该特定任务在大学中最有技能的学生。选择是使用多项选择问卷进行的。因此，一小部分通过随机猜测程序回答问卷的不好的学生，可能会被偶然选中。用于确定最佳学生的测试是有缺陷的，就像所有测试一样。
- en: These spuriously selected students will not have the most common profile among
    those we may encounter in the amphitheater. Most of the students selected are
    skilled, however, since they all come from the same university, they share the
    same knowledge and ideas about financial markets.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 这些被毫无原则地选择出来的学生在我们在大礼堂里可能会遇到的学生中并不具有最常见的特征。然而，大多数被选择的学生都很有技能，因为他们都来自同一所大学，他们对金融市场有着相同的知识和想法。
- en: However, some of the students started their studies in other universities, even
    in different fields in a few cases, and some of them study more than others, looking
    for complementary information outside of the lectures, hence, some original views
    may be expressed by those students.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，一些学生在其他大学开始了他们的学习，甚至在少数情况下在不同领域开始了他们的学习，而且他们中的一些人比其他人学习得更多，在讲座之外寻找补充信息，因此，一些原始观点可能会被这些学生表达出来。
- en: The predictions made by the students are anonymous, thus we can’t know who these
    original students are. We only observe the predictions, which are repeated for
    several rounds, trying each time to predict the return of the financial asset
    for the next period.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 学生们所做的预测是匿名的，因此我们无法知道这些原始学生是谁。我们只能观察到这些预测，这些预测在几轮中重复，每次都试图预测下一个时期的金融资产收益。
- en: It is quite transparent that the amphitheater is a polymodel, and that each
    of the students represents an elementary model. Also, we clearly understand that
    the predictions of most of the students, even if relevant, would be correlated,
    since the way they represent the market would be essentially the same. The question
    is then how to distinguish the wise, the fool and the crowd. This question can
    be addressed in several ways, and we propose to tackle it through a measure that
    considers both originality and believability, which is presented in Chap. [6](519851_1_En_6_Chapter.xhtml).
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 很明显，大礼堂是一个多模型，每个学生代表着一个基本模型。此外，我们清楚地了解到，大多数学生的预测，即使相关，也会有所关联，因为他们代表市场的方式本质上是相同的。问题是如何区分智者、愚者和群众。这个问题可以通过几种方式来解决，我们提议通过一个同时考虑到原创性和可信度的度量来解决，该度量在第[6](519851_1_En_6_Chapter.xhtml)章中提出。
- en: 2.5.2 Number of Variables Per Elementary Model
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.5.2每个基本模型的变量数量
- en: The choice of including only a single variable per elementary model needs to
    be discussed. Indeed, most of the benefits of the polymodels are preserved if
    the elementary models are composed of several variables. Such a construction is
    also in line with the epistemological approach of Polymodel Theory.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 选择只包括基本模型中的单个变量需要进行讨论。事实上，如果基本模型由多个变量组成，则大多数Polymodel的好处仍然存在。这样的构造也符合Polymodel理论的认识论方法。
- en: Nonetheless, including several variables in elementary models would not allow
    us to have a high level of precision (i.e. non-linear modeling) without overfitting.
    Some of the other benefits, for example the absence of multicollinearity, would
    be lost.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，将几个变量包括在基本模型中将不允许我们在没有过度拟合的情况下获得高水平的精度（即非线性建模）。例如，多重共线性的缺失将会丢失一些其他的好处。
- en: Apart from statistical considerations, the use of univariate elementary models
    simplifies a lot the analysis, since it is clear that the metrics that we measure
    on the elementary models are associated with a single, well-identified factor.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 除了统计考虑之外，使用单变量基本模型大大简化了分析，因为我们测量的基本模型指标与一个单一、明确定义的因子相关联。
- en: Thus, univariate elementary models seem to be the most appropriate choice for
    the construction of the polymodels.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，单变量基本模型似乎是构建Polymodel的最合适选择。
- en: 2.6 Conclusions
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.6 结论
- en: Polymodel Theory is an intuitive approach that has been used in different fields
    for a long time, but it has often been hastily rejected in favor of multivariate
    modeling. However, the first applications in finance show that the method provides
    a rich framework, particularly favorable to the non-linear modeling of big data,
    with a large panel of applications outside of the scope of multivariate modeling.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: Polymodel理论是一种直观的方法，长期以来已经在不同领域中使用，但通常会被匆忙地拒绝，以支持多变量建模。然而，金融领域的首次应用表明，该方法提供了一个丰富的框架，特别有利于大数据的非线性建模，在多变量建模范围之外有大量应用。
- en: Formalizing a tool that is increasingly used in the recent literature, we have
    shown that the multi-univariate approach of polymodels has many favorable qualities
    from an econometrical point of view. In particular, these advantages are in line
    with the current stakes of finance, in which techniques that can handle large
    amounts of data in a data-driven, robust, accurate, and non-overfitted manner
    are required. From this perspective, Polymodel Theory can be seen as a machine
    learning method.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 形式化一个在最近文献中越来越常用的工具，我们已经表明多元多变量(polymodels)方法在计量经济学角度具有许多有利特性。特别地，这些优点符合当前金融利益，其中需要以数据驱动、稳健、准确、非过度拟合的方式处理大量数据的技术。从这个角度来看，Polymodel理论可以被看作是一种机器学习方法。
- en: 'Polymodel Theory also has philosophical benefits: from the point of view of
    epistemology it seems to be a more reasonable approach than multivariate modeling,
    since it provides several representations of the same object (that can be weighted
    according to believability) in lieu of a single, immutable representation.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: Polymodel理论还具有哲学上的好处：从认识论的角度来看，它似乎比多变量建模更合理，因为它提供了同一对象的多种表示（可以根据可信度加权），而不是单一的、不变的表示。
- en: The non-linearity of polymodels makes it possible to efficiently tackle regime
    changes in the market dynamics that are “spatial”, that is, due to the size of
    the moves, rather than to a random “temporal” event. This is in line with, for
    instance, hidden Markov models in which the “beta” of stocks with respect to certain
    indices depends on the regime.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: Polymodel的非线性使得可以有效地处理市场动态中的制度变化，这些变化是“空间”的，即由于移动的大小而不是由于随机的“时间”事件。这与例如隐藏的马尔可夫模型一致，在其中股票对某些指数的“beta”取决于制度。
- en: The challenges of estimating, selecting and aggregating the predictions are
    important topics that are addressed in the following chapters. Managing these
    questions properly is the cornerstone of the use of polymodels. Still, if properly
    handled, it makes Polymodel Theory a powerful modeling method, and to some extent,
    a superior alternative to most of the traditional multivariate regression techniques.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 估计、选择和聚合预测的挑战是接下来章节要讨论的重要话题。妥善处理这些问题是使用Polymodel的基石。但是，如果得到适当处理，这使得Polymodel理论成为一种强大的建模方法，并在某种程度上，成为大多数传统多变量回归技术的优越替代品。
